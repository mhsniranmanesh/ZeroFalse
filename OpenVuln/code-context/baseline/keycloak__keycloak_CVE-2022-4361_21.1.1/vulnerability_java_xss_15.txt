# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/SamlSPFacade.java, Line 69, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/SamlSPFacade.java
```java
      64:             resp.setHeader("Location", builder.build().toString());
      65:             return;
      66:         }
      67: 
      68:         System.out.println("Response was received");
>>>   69:         samlResponse = req.getParameter("SAMLResponse");
      70:         sentRelayState = req.getParameter("RelayState");
      71: 
      72:         PrintWriter pw = resp.getWriter();
      73:         pw.println("Relay state: " + sentRelayState);
      74:         pw.println("SAML response: " + samlResponse);
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/SamlSPFacade.java, Line 74, Column 20
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/SamlSPFacade.java
```java
      69:         samlResponse = req.getParameter("SAMLResponse");
      70:         sentRelayState = req.getParameter("RelayState");
      71: 
      72:         PrintWriter pw = resp.getWriter();
      73:         pw.println("Relay state: " + sentRelayState);
>>>   74:         pw.println("SAML response: " + samlResponse);
      75:         pw.flush();
      76:     }
      77: 
      78:    /*
      79:     * https://idp.ssocircle.com/sso/toolbox/samlEncode.jsp
```
