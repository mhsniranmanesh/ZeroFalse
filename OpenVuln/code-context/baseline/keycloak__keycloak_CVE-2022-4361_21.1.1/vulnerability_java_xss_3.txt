# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).
Cross-site scripting vulnerability due to a [user-provided value](2).
Cross-site scripting vulnerability due to a [user-provided value](3).
Cross-site scripting vulnerability due to a [user-provided value](4).
Cross-site scripting vulnerability due to a [user-provided value](5).
Cross-site scripting vulnerability due to a [user-provided value](6).
Cross-site scripting vulnerability due to a [user-provided value](7).
Cross-site scripting vulnerability due to a [user-provided value](8).
Cross-site scripting vulnerability due to a [user-provided value](9).
Cross-site scripting vulnerability due to a [user-provided value](10).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java, Line 49, Column 52
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java
```java
      44:     public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
      45:             throws IOException {
      46:         HttpServletRequest req = (HttpServletRequest) request;
      47: 
      48:         if (req.getRequestURI().endsWith("/body")) {
>>>   49:             Map body = JsonSerialization.readValue(request.getInputStream(), Map.class);
      50:             response.setContentType("application/json");
      51:             PrintWriter writer = response.getWriter();
      52:             writer.println(JsonSerialization.writeValueAsString(body));
      53:             writer.flush();
      54:         }
```

### Data Flow Step 2: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 78, Column 35
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
      73: 
      74:     public static <T> T readValue(String bytes, Class<T> type) throws IOException {
      75:         return mapper.readValue(bytes, type);
      76:     }
      77: 
>>>   78:     public static <T> T readValue(InputStream bytes, Class<T> type) throws IOException {
      79:         return readValue(bytes, type, false);
      80:     }
      81: 
      82:     public static <T> T readValue(String string, TypeReference<T> type) throws IOException {
      83:         return mapper.readValue(string, type);
```

### Data Flow Step 3: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 79, Column 26
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
      74:     public static <T> T readValue(String bytes, Class<T> type) throws IOException {
      75:         return mapper.readValue(bytes, type);
      76:     }
      77: 
      78:     public static <T> T readValue(InputStream bytes, Class<T> type) throws IOException {
>>>   79:         return readValue(bytes, type, false);
      80:     }
      81: 
      82:     public static <T> T readValue(String string, TypeReference<T> type) throws IOException {
      83:         return mapper.readValue(string, type);
      84:     }
```

### Data Flow Step 4: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 90, Column 35
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
      85: 
      86:     public static <T> T readValue(InputStream bytes, TypeReference<T> type) throws IOException {
      87:         return mapper.readValue(bytes, type);
      88:     }
      89: 
>>>   90:     public static <T> T readValue(InputStream bytes, Class<T> type, boolean replaceSystemProperties) throws IOException {
      91:         if (replaceSystemProperties) {
      92:             return sysPropertiesAwareMapper.readValue(bytes, type);
      93:         } else {
      94:             return mapper.readValue(bytes, type);
      95:         }
```

### Data Flow Step 5: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 94, Column 20
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
      89: 
      90:     public static <T> T readValue(InputStream bytes, Class<T> type, boolean replaceSystemProperties) throws IOException {
      91:         if (replaceSystemProperties) {
      92:             return sysPropertiesAwareMapper.readValue(bytes, type);
      93:         } else {
>>>   94:             return mapper.readValue(bytes, type);
      95:         }
      96:     }
      97: 
      98:     /**
      99:      * Creates an {@link ObjectNode} based on the given {@code pojo}, copying all its properties to the resulting {@link ObjectNode}.
```

### Data Flow Step 6: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 79, Column 16
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
      74:     public static <T> T readValue(String bytes, Class<T> type) throws IOException {
      75:         return mapper.readValue(bytes, type);
      76:     }
      77: 
      78:     public static <T> T readValue(InputStream bytes, Class<T> type) throws IOException {
>>>   79:         return readValue(bytes, type, false);
      80:     }
      81: 
      82:     public static <T> T readValue(String string, TypeReference<T> type) throws IOException {
      83:         return mapper.readValue(string, type);
      84:     }
```

### Data Flow Step 7: testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java, Line 49, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java
```java
      44:     public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
      45:             throws IOException {
      46:         HttpServletRequest req = (HttpServletRequest) request;
      47: 
      48:         if (req.getRequestURI().endsWith("/body")) {
>>>   49:             Map body = JsonSerialization.readValue(request.getInputStream(), Map.class);
      50:             response.setContentType("application/json");
      51:             PrintWriter writer = response.getWriter();
      52:             writer.println(JsonSerialization.writeValueAsString(body));
      53:             writer.flush();
      54:         }
```

### Data Flow Step 8: testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java, Line 52, Column 65
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java
```java
      47: 
      48:         if (req.getRequestURI().endsWith("/body")) {
      49:             Map body = JsonSerialization.readValue(request.getInputStream(), Map.class);
      50:             response.setContentType("application/json");
      51:             PrintWriter writer = response.getWriter();
>>>   52:             writer.println(JsonSerialization.writeValueAsString(body));
      53:             writer.flush();
      54:         }
      55:     }
      56: 
      57:     @Override
```

### Data Flow Step 9: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 62, Column 45
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
      57:     }
      58: 
      59:     public static String writeValueAsPrettyString(Object obj) throws IOException {
      60:         return prettyMapper.writeValueAsString(obj);
      61:     }
>>>   62:     public static String writeValueAsString(Object obj) throws IOException {
      63:         return mapper.writeValueAsString(obj);
      64:     }
      65: 
      66:     public static byte[] writeValueAsBytes(Object obj) throws IOException {
      67:         return mapper.writeValueAsBytes(obj);
```

### Data Flow Step 10: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 63, Column 16
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
      58: 
      59:     public static String writeValueAsPrettyString(Object obj) throws IOException {
      60:         return prettyMapper.writeValueAsString(obj);
      61:     }
      62:     public static String writeValueAsString(Object obj) throws IOException {
>>>   63:         return mapper.writeValueAsString(obj);
      64:     }
      65: 
      66:     public static byte[] writeValueAsBytes(Object obj) throws IOException {
      67:         return mapper.writeValueAsBytes(obj);
      68:     }
```

### Data Flow Step 11: testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java, Line 52, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java
```java
      47: 
      48:         if (req.getRequestURI().endsWith("/body")) {
      49:             Map body = JsonSerialization.readValue(request.getInputStream(), Map.class);
      50:             response.setContentType("application/json");
      51:             PrintWriter writer = response.getWriter();
>>>   52:             writer.println(JsonSerialization.writeValueAsString(body));
      53:             writer.flush();
      54:         }
      55:     }
      56: 
      57:     @Override
```

### Data Flow Step 12: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 33, Column 25
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
      28:     public PrintWriterNoJavaLang(Writer out) {
      29:         super(out);
      30:     }
      31: 
      32:     @Override
>>>   33:     public void println(String x) {
      34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
      35:     }
      36: 
      37: }
```

### Data Flow Step 13: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 34, Column 23
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
      29:         super(out);
      30:     }
      31: 
      32:     @Override
      33:     public void println(String x) {
>>>   34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
      35:     }
      36: 
      37: }
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 78, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
      73:         } else if (request.getRequestURI().endsWith("/link") && request.getParameter("response") != null) {
      74:             resp.setStatus(200);
      75:             resp.setContentType("text/html");
      76:             PrintWriter pw = resp.getWriter();
      77:             pw.printf("<html><head><title>%s</title></head><body>", "Client Linking");
>>>   78:             String error = request.getParameter("link_error");
      79:             if (error != null) {
      80:                 pw.println("Link error: " + error);
      81:             } else {
      82:                 pw.println("Account Linked");
      83:             }
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 80, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
      75:             resp.setContentType("text/html");
      76:             PrintWriter pw = resp.getWriter();
      77:             pw.printf("<html><head><title>%s</title></head><body>", "Client Linking");
      78:             String error = request.getParameter("link_error");
      79:             if (error != null) {
>>>   80:                 pw.println("Link error: " + error);
      81:             } else {
      82:                 pw.println("Account Linked");
      83:             }
      84:             pw.print("</body></html>");
      85:             pw.flush();
```

### Data Flow Step 3: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 33, Column 25
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
      28:     public PrintWriterNoJavaLang(Writer out) {
      29:         super(out);
      30:     }
      31: 
      32:     @Override
>>>   33:     public void println(String x) {
      34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
      35:     }
      36: 
      37: }
```

### Data Flow Step 4: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 34, Column 23
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
      29:         super(out);
      30:     }
      31: 
      32:     @Override
      33:     public void println(String x) {
>>>   34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
      35:     }
      36: 
      37: }
```

## Code Flow 3

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 91, Column 46
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
      86:         } else {
      87:             resp.setStatus(200);
      88:             resp.setContentType("text/html");
      89:             PrintWriter pw = resp.getWriter();
      90:             pw.printf("<html><head><title>%s</title></head><body>", "Client Linking");
>>>   91:             pw.println("Unknown request: " + request.getRequestURL().toString());
      92:             pw.print("</body></html>");
      93:             pw.flush();
      94: 
      95:         }
      96: 
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 91, Column 46
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
      86:         } else {
      87:             resp.setStatus(200);
      88:             resp.setContentType("text/html");
      89:             PrintWriter pw = resp.getWriter();
      90:             pw.printf("<html><head><title>%s</title></head><body>", "Client Linking");
>>>   91:             pw.println("Unknown request: " + request.getRequestURL().toString());
      92:             pw.print("</body></html>");
      93:             pw.flush();
      94: 
      95:         }
      96: 
```

### Data Flow Step 3: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 91, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
      86:         } else {
      87:             resp.setStatus(200);
      88:             resp.setContentType("text/html");
      89:             PrintWriter pw = resp.getWriter();
      90:             pw.printf("<html><head><title>%s</title></head><body>", "Client Linking");
>>>   91:             pw.println("Unknown request: " + request.getRequestURL().toString());
      92:             pw.print("</body></html>");
      93:             pw.flush();
      94: 
      95:         }
      96: 
```

### Data Flow Step 4: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 33, Column 25
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
      28:     public PrintWriterNoJavaLang(Writer out) {
      29:         super(out);
      30:     }
      31: 
      32:     @Override
>>>   33:     public void println(String x) {
      34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
      35:     }
      36: 
      37: }
```

### Data Flow Step 5: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 34, Column 23
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
      29:         super(out);
      30:     }
      31: 
      32:     @Override
      33:     public void println(String x) {
>>>   34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
      35:     }
      36: 
      37: }
```

## Code Flow 4

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 61, Column 78
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      56: 
      57:                 URL url = new URL(urlBase + "/customer-db/");
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
>>>   61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 61, Column 56
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      56: 
      57:                 URL url = new URL(urlBase + "/customer-db/");
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
>>>   61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
```

### Data Flow Step 3: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 61, Column 37
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      56: 
      57:                 URL url = new URL(urlBase + "/customer-db/");
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
>>>   61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
```

### Data Flow Step 4: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 63, Column 32
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
>>>   63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
      67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
```

### Data Flow Step 5: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 63, Column 32
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
>>>   63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
      67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
```

### Data Flow Step 6: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 64, Column 35
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
>>>   64:                     result.append(line);
      65:                 }
      66:                 rd.close();
      67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
      69:                 req.logout();
```

### Data Flow Step 7: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 64, Column 21
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
>>>   64:                     result.append(line);
      65:                 }
      66:                 rd.close();
      67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
      69:                 req.logout();
```

### Data Flow Step 8: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 67, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
>>>   67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
      69:                 req.logout();
      70:                 pw.flush();
      71:                 return;
      72:             }
```

### Data Flow Step 9: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 67, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
>>>   67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
      69:                 req.logout();
      70:                 pw.flush();
      71:                 return;
      72:             }
```

### Data Flow Step 10: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 33, Column 25
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
      28:     public PrintWriterNoJavaLang(Writer out) {
      29:         super(out);
      30:     }
      31: 
      32:     @Override
>>>   33:     public void println(String x) {
      34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
      35:     }
      36: 
      37: }
```

### Data Flow Step 11: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 34, Column 23
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
      29:         super(out);
      30:     }
      31: 
      32:     @Override
      33:     public void println(String x) {
>>>   34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
      35:     }
      36: 
      37: }
```
