# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 61, Column 78
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      56: 
      57:                 URL url = new URL(urlBase + "/customer-db/");
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
>>>   61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 61, Column 56
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      56: 
      57:                 URL url = new URL(urlBase + "/customer-db/");
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
>>>   61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
```

### Data Flow Step 3: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 61, Column 37
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      56: 
      57:                 URL url = new URL(urlBase + "/customer-db/");
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
>>>   61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
```

### Data Flow Step 4: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 63, Column 32
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
>>>   63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
      67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
```

### Data Flow Step 5: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 63, Column 32
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      58:                 HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
>>>   63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
      67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
```

### Data Flow Step 6: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 64, Column 35
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
>>>   64:                     result.append(line);
      65:                 }
      66:                 rd.close();
      67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
      69:                 req.logout();
```

### Data Flow Step 7: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 64, Column 21
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      59:                 conn.setRequestMethod("DELETE");
      60:                 conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
>>>   64:                     result.append(line);
      65:                 }
      66:                 rd.close();
      67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
      69:                 req.logout();
```

### Data Flow Step 8: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 67, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
>>>   67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
      69:                 req.logout();
      70:                 pw.flush();
      71:                 return;
      72:             }
```

### Data Flow Step 9: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 67, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
      64:                     result.append(line);
      65:                 }
      66:                 rd.close();
>>>   67:                 pw.println(result.toString());
      68:                 // Call logout before pw.flush
      69:                 req.logout();
      70:                 pw.flush();
      71:                 return;
      72:             }
```
