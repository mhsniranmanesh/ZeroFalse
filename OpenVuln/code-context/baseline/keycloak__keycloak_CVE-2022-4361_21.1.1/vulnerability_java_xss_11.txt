# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java, Line 65, Column 70
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java
```java
      60: 
      61:         URL url = new URL(urlBase + "/customer-db/");
      62:         HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      63:         conn.setRequestMethod("GET");
      64:         conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
>>>   65:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      66:         String line;
      67:         while ((line = rd.readLine()) != null) {
      68:             result.append(line);
      69:         }
      70:         rd.close();
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java, Line 65, Column 48
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java
```java
      60: 
      61:         URL url = new URL(urlBase + "/customer-db/");
      62:         HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      63:         conn.setRequestMethod("GET");
      64:         conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
>>>   65:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      66:         String line;
      67:         while ((line = rd.readLine()) != null) {
      68:             result.append(line);
      69:         }
      70:         rd.close();
```

### Data Flow Step 3: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java, Line 65, Column 29
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java
```java
      60: 
      61:         URL url = new URL(urlBase + "/customer-db/");
      62:         HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      63:         conn.setRequestMethod("GET");
      64:         conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
>>>   65:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      66:         String line;
      67:         while ((line = rd.readLine()) != null) {
      68:             result.append(line);
      69:         }
      70:         rd.close();
```

### Data Flow Step 4: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java, Line 67, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java
```java
      62:         HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      63:         conn.setRequestMethod("GET");
      64:         conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      65:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      66:         String line;
>>>   67:         while ((line = rd.readLine()) != null) {
      68:             result.append(line);
      69:         }
      70:         rd.close();
      71:         resp.setContentType("text/html");
      72:         pw.println(result.toString());
```

### Data Flow Step 5: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java, Line 67, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java
```java
      62:         HttpURLConnection conn = (HttpURLConnection) url.openConnection();
      63:         conn.setRequestMethod("GET");
      64:         conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      65:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      66:         String line;
>>>   67:         while ((line = rd.readLine()) != null) {
      68:             result.append(line);
      69:         }
      70:         rd.close();
      71:         resp.setContentType("text/html");
      72:         pw.println(result.toString());
```

### Data Flow Step 6: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java, Line 68, Column 27
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java
```java
      63:         conn.setRequestMethod("GET");
      64:         conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      65:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      66:         String line;
      67:         while ((line = rd.readLine()) != null) {
>>>   68:             result.append(line);
      69:         }
      70:         rd.close();
      71:         resp.setContentType("text/html");
      72:         pw.println(result.toString());
      73:         pw.flush();
```

### Data Flow Step 7: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java, Line 68, Column 13
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java
```java
      63:         conn.setRequestMethod("GET");
      64:         conn.setRequestProperty(HttpHeaders.AUTHORIZATION, "Bearer " + context.getTokenString());
      65:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
      66:         String line;
      67:         while ((line = rd.readLine()) != null) {
>>>   68:             result.append(line);
      69:         }
      70:         rd.close();
      71:         resp.setContentType("text/html");
      72:         pw.println(result.toString());
      73:         pw.flush();
```

### Data Flow Step 8: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java, Line 72, Column 20
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java
```java
      67:         while ((line = rd.readLine()) != null) {
      68:             result.append(line);
      69:         }
      70:         rd.close();
      71:         resp.setContentType("text/html");
>>>   72:         pw.println(result.toString());
      73:         pw.flush();
      74: //
      75: //            Response response = target.request().get();
      76: //            if (response.getStatus() != 401) { // assert response status == 401
      77: //                throw new AssertionError("Response status code is not 401.");
```

### Data Flow Step 9: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java, Line 72, Column 20
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServletNoConf.java
```java
      67:         while ((line = rd.readLine()) != null) {
      68:             result.append(line);
      69:         }
      70:         rd.close();
      71:         resp.setContentType("text/html");
>>>   72:         pw.println(result.toString());
      73:         pw.flush();
      74: //
      75: //            Response response = target.request().get();
      76: //            if (response.getStatus() != 401) { // assert response status == 401
      77: //                throw new AssertionError("Response status code is not 401.");
```
