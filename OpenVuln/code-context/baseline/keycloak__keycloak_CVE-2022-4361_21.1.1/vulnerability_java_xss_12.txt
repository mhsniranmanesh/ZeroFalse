# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/LinkAndExchangeServlet.java, Line 155, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/LinkAndExchangeServlet.java
```java
     150:         } else if (request.getRequestURI().endsWith("/link") && request.getParameter("response") != null) {
     151:             resp.setStatus(200);
     152:             resp.setContentType("text/html");
     153:             PrintWriter pw = resp.getWriter();
     154:             pw.printf("<html><head><title>%s</title></head><body>", "Client Linking");
>>>  155:             String error = request.getParameter("link_error");
     156:             if (error != null) {
     157:                 pw.println("Link error: " + error);
     158:             } else {
     159:                 pw.println("Account Linked");
     160:             }
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/LinkAndExchangeServlet.java, Line 157, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/LinkAndExchangeServlet.java
```java
     152:             resp.setContentType("text/html");
     153:             PrintWriter pw = resp.getWriter();
     154:             pw.printf("<html><head><title>%s</title></head><body>", "Client Linking");
     155:             String error = request.getParameter("link_error");
     156:             if (error != null) {
>>>  157:                 pw.println("Link error: " + error);
     158:             } else {
     159:                 pw.println("Account Linked");
     160:             }
     161:             pw.println("trying exchange");
     162:             try {
```
