# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 105, Column 70
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
     100:         if (conn.getResponseCode() != 200) {
     101:             conn.getErrorStream().close();
     102:             return "Service returned: " + conn.getResponseCode();
     103:         }
     104: 
>>>  105:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
     106:         String line;
     107:         while ((line = rd.readLine()) != null) {
     108:             result.append(line);
     109:         }
     110:         rd.close();
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 105, Column 48
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
     100:         if (conn.getResponseCode() != 200) {
     101:             conn.getErrorStream().close();
     102:             return "Service returned: " + conn.getResponseCode();
     103:         }
     104: 
>>>  105:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
     106:         String line;
     107:         while ((line = rd.readLine()) != null) {
     108:             result.append(line);
     109:         }
     110:         rd.close();
```

### Data Flow Step 3: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 105, Column 29
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
     100:         if (conn.getResponseCode() != 200) {
     101:             conn.getErrorStream().close();
     102:             return "Service returned: " + conn.getResponseCode();
     103:         }
     104: 
>>>  105:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
     106:         String line;
     107:         while ((line = rd.readLine()) != null) {
     108:             result.append(line);
     109:         }
     110:         rd.close();
```

### Data Flow Step 4: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 107, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
     102:             return "Service returned: " + conn.getResponseCode();
     103:         }
     104: 
     105:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
     106:         String line;
>>>  107:         while ((line = rd.readLine()) != null) {
     108:             result.append(line);
     109:         }
     110:         rd.close();
     111: 
     112:         return result.toString();
```

### Data Flow Step 5: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 107, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
     102:             return "Service returned: " + conn.getResponseCode();
     103:         }
     104: 
     105:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
     106:         String line;
>>>  107:         while ((line = rd.readLine()) != null) {
     108:             result.append(line);
     109:         }
     110:         rd.close();
     111: 
     112:         return result.toString();
```

### Data Flow Step 6: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 108, Column 27
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
     103:         }
     104: 
     105:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
     106:         String line;
     107:         while ((line = rd.readLine()) != null) {
>>>  108:             result.append(line);
     109:         }
     110:         rd.close();
     111: 
     112:         return result.toString();
     113:     }
```

### Data Flow Step 7: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 108, Column 13
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
     103:         }
     104: 
     105:         BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
     106:         String line;
     107:         while ((line = rd.readLine()) != null) {
>>>  108:             result.append(line);
     109:         }
     110:         rd.close();
     111: 
     112:         return result.toString();
     113:     }
```

### Data Flow Step 8: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 112, Column 16
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
     107:         while ((line = rd.readLine()) != null) {
     108:             result.append(line);
     109:         }
     110:         rd.close();
     111: 
>>>  112:         return result.toString();
     113:     }
     114: 
     115: }
```

### Data Flow Step 9: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 112, Column 16
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
     107:         while ((line = rd.readLine()) != null) {
     108:             result.append(line);
     109:         }
     110:         rd.close();
     111: 
>>>  112:         return result.toString();
     113:     }
     114: 
     115: }
```

### Data Flow Step 10: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 84, Column 29
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      79:                 serviceUrl = urlBase + "/customer-db-audience-required/";
      80:             } else {
      81:                 serviceUrl = urlBase + "/customer-db/";
      82:             }
      83: 
>>>   84:             String result = invokeService(serviceUrl, context);
      85: 
      86:             resp.setContentType("text/html");
      87:             pw.println(result);
      88:             pw.flush();
      89:         }
```

### Data Flow Step 11: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 87, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
      82:             }
      83: 
      84:             String result = invokeService(serviceUrl, context);
      85: 
      86:             resp.setContentType("text/html");
>>>   87:             pw.println(result);
      88:             pw.flush();
      89:         }
      90:     }
      91: 
      92:     private String invokeService(String serviceUrl, KeycloakSecurityContext context) throws IOException {
```
