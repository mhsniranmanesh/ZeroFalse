# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     468:      */
     469:     @Override
     470:     public String getHttpParameter( final String paramName ) {
     471:         String result = null;
     472:         if( m_request != null ) {
>>>  473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
     476:         return result;
     477:     }
     478: 
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     471:         String result = null;
     472:         if( m_request != null ) {
     473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
>>>  476:         return result;
     477:     }
     478: 
     479:     /**
     480:      *  If the request did originate from an HTTP request, then the HTTP request can be fetched here.  However, if the request
     481:      *  did NOT originate from an HTTP request, then this method will return null, and YOU SHOULD CHECK FOR IT!
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java, Line 204, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java
```java
     199:             }
     200:         }
     201: 
     202: 
     203:         if( (startDay = params.get(PARAM_STARTDATE)) == null ) {
>>>  204:             startDay = context.getHttpParameter( "weblog."+PARAM_STARTDATE );
     205:         }
     206: 
     207:         if( TextUtil.isPositive( params.get(PARAM_ALLOWCOMMENTS) ) ) {
     208:             hasComments = true;
     209:         }
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java, Line 226, Column 74
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java
```java
     221:             try {
     222:                 final Date d = fmt.parse( startDay );
     223:                 startTime.setTime( d );
     224:                 stopTime.setTime( d );
     225:             } catch( final ParseException e ) {
>>>  226:                 return "Illegal time format: "+ TextUtil.replaceEntities(startDay);
     227:             }
     228:         }
     229: 
     230:         //
     231:         //  Mark this to be a weblog
```

### Data Flow Step 5: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     209:      *
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
>>>  214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
```

### Data Flow Step 6: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 7: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 8: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
>>>  220:         return src;
     221:     }
     222: 
     223:     /**
     224:      *  Replaces a string with another string.
     225:      *
```

### Data Flow Step 23: jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java, Line 226, Column 49
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java
```java
     221:             try {
     222:                 final Date d = fmt.parse( startDay );
     223:                 startTime.setTime( d );
     224:                 stopTime.setTime( d );
     225:             } catch( final ParseException e ) {
>>>  226:                 return "Illegal time format: "+ TextUtil.replaceEntities(startDay);
     227:             }
     228:         }
     229: 
     230:         //
     231:         //  Mark this to be a weblog
```

### Data Flow Step 24: jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java, Line 226, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java
```java
     221:             try {
     222:                 final Date d = fmt.parse( startDay );
     223:                 startTime.setTime( d );
     224:                 stopTime.setTime( d );
     225:             } catch( final ParseException e ) {
>>>  226:                 return "Illegal time format: "+ TextUtil.replaceEntities(startDay);
     227:             }
     228:         }
     229: 
     230:         //
     231:         //  Mark this to be a weblog
```

### Data Flow Step 25: jspwiki-main/src/main/java/org/apache/wiki/plugin/DefaultPluginManager.java, Line 279, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/DefaultPluginManager.java
```java
     274:                 return "Plugin '" + classname + "' not compatible with this version of JSPWiki";
     275:             }
     276: 
     277:             //  ...and launch.
     278:             try {
>>>  279:                 return plugin.execute( context, params );
     280:             } catch( final PluginException e ) {
     281:                 if( debug ) {
     282:                     return stackTrace( params, e );
     283:                 }
     284: 
```

### Data Flow Step 26: jspwiki-main/src/main/java/org/apache/wiki/tags/PluginTag.java, Line 108, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/PluginTag.java
```java
     103:         if( body != null )
     104:         {
     105:             argmap.put( "_body", body );
     106:         }
     107: 
>>>  108:         return pm.execute( m_wikiContext, plugin, argmap );
     109:     }
     110: 
     111:     /**
     112:      *  {@inheritDoc}
     113:      */
```

### Data Flow Step 27: jspwiki-main/src/main/java/org/apache/wiki/tags/PluginTag.java, Line 122, Column 45
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/PluginTag.java
```java
     117:     {
     118:         if( !m_evaluated )
     119:         {
     120:             try
     121:             {
>>>  122:                 pageContext.getOut().write( executePlugin( m_plugin, m_args, null ) );
     123:             }
     124:             catch( final Exception e )
     125:             {
     126:                 LOG.error( "Failed to insert plugin", e );
     127:                 throw new JspException( "Tag failed, check logs: "+e.getMessage() );
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     468:      */
     469:     @Override
     470:     public String getHttpParameter( final String paramName ) {
     471:         String result = null;
     472:         if( m_request != null ) {
>>>  473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
     476:         return result;
     477:     }
     478: 
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     471:         String result = null;
     472:         if( m_request != null ) {
     473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
>>>  476:         return result;
     477:     }
     478: 
     479:     /**
     480:      *  If the request did originate from an HTTP request, then the HTTP request can be fetched here.  However, if the request
     481:      *  did NOT originate from an HTTP request, then this method will return null, and YOU SHOULD CHECK FOR IT!
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java, Line 204, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java
```java
     199:             }
     200:         }
     201: 
     202: 
     203:         if( (startDay = params.get(PARAM_STARTDATE)) == null ) {
>>>  204:             startDay = context.getHttpParameter( "weblog."+PARAM_STARTDATE );
     205:         }
     206: 
     207:         if( TextUtil.isPositive( params.get(PARAM_ALLOWCOMMENTS) ) ) {
     208:             hasComments = true;
     209:         }
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java, Line 226, Column 74
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java
```java
     221:             try {
     222:                 final Date d = fmt.parse( startDay );
     223:                 startTime.setTime( d );
     224:                 stopTime.setTime( d );
     225:             } catch( final ParseException e ) {
>>>  226:                 return "Illegal time format: "+ TextUtil.replaceEntities(startDay);
     227:             }
     228:         }
     229: 
     230:         //
     231:         //  Mark this to be a weblog
```

### Data Flow Step 5: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     209:      *
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
>>>  214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
```

### Data Flow Step 6: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 7: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 8: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 23: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 24: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 25: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 26: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 27: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 28: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 29: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 30: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 31: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 32: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 33: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 34: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
>>>  220:         return src;
     221:     }
     222: 
     223:     /**
     224:      *  Replaces a string with another string.
     225:      *
```

### Data Flow Step 35: jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java, Line 226, Column 49
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java
```java
     221:             try {
     222:                 final Date d = fmt.parse( startDay );
     223:                 startTime.setTime( d );
     224:                 stopTime.setTime( d );
     225:             } catch( final ParseException e ) {
>>>  226:                 return "Illegal time format: "+ TextUtil.replaceEntities(startDay);
     227:             }
     228:         }
     229: 
     230:         //
     231:         //  Mark this to be a weblog
```

### Data Flow Step 36: jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java, Line 226, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/WeblogPlugin.java
```java
     221:             try {
     222:                 final Date d = fmt.parse( startDay );
     223:                 startTime.setTime( d );
     224:                 stopTime.setTime( d );
     225:             } catch( final ParseException e ) {
>>>  226:                 return "Illegal time format: "+ TextUtil.replaceEntities(startDay);
     227:             }
     228:         }
     229: 
     230:         //
     231:         //  Mark this to be a weblog
```

### Data Flow Step 37: jspwiki-main/src/main/java/org/apache/wiki/plugin/DefaultPluginManager.java, Line 279, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/plugin/DefaultPluginManager.java
```java
     274:                 return "Plugin '" + classname + "' not compatible with this version of JSPWiki";
     275:             }
     276: 
     277:             //  ...and launch.
     278:             try {
>>>  279:                 return plugin.execute( context, params );
     280:             } catch( final PluginException e ) {
     281:                 if( debug ) {
     282:                     return stackTrace( params, e );
     283:                 }
     284: 
```

### Data Flow Step 38: jspwiki-main/src/main/java/org/apache/wiki/tags/PluginTag.java, Line 108, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/PluginTag.java
```java
     103:         if( body != null )
     104:         {
     105:             argmap.put( "_body", body );
     106:         }
     107: 
>>>  108:         return pm.execute( m_wikiContext, plugin, argmap );
     109:     }
     110: 
     111:     /**
     112:      *  {@inheritDoc}
     113:      */
```

### Data Flow Step 39: jspwiki-main/src/main/java/org/apache/wiki/tags/PluginTag.java, Line 122, Column 45
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/PluginTag.java
```java
     117:     {
     118:         if( !m_evaluated )
     119:         {
     120:             try
     121:             {
>>>  122:                 pageContext.getOut().write( executePlugin( m_plugin, m_args, null ) );
     123:             }
     124:             catch( final Exception e )
     125:             {
     126:                 LOG.error( "Failed to insert plugin", e );
     127:                 throw new JspException( "Tag failed, check logs: "+e.getMessage() );
```
