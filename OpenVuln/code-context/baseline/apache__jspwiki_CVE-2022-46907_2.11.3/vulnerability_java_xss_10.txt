# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     468:      */
     469:     @Override
     470:     public String getHttpParameter( final String paramName ) {
     471:         String result = null;
     472:         if( m_request != null ) {
>>>  473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
     476:         return result;
     477:     }
     478: 
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     471:         String result = null;
     472:         if( m_request != null ) {
     473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
>>>  476:         return result;
     477:     }
     478: 
     479:     /**
     480:      *  If the request did originate from an HTTP request, then the HTTP request can be fetched here.  However, if the request
     481:      *  did NOT originate from an HTTP request, then this method will return null, and YOU SHOULD CHECK FOR IT!
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 200, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
     195: 
     196:                     if( s != null ) {
     197:                         return s;
     198:                     }
     199: 
>>>  200:                     s = context.getHttpParameter( varName );
     201:                     if( s != null ) {
     202:                         return s;
     203:                     }
     204:                 } catch( final ClassCastException e ) {
     205:                     LOG.debug( "Not a String: " + varName );
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 202, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
     197:                         return s;
     198:                     }
     199: 
     200:                     s = context.getHttpParameter( varName );
     201:                     if( s != null ) {
>>>  202:                         return s;
     203:                     }
     204:                 } catch( final ClassCastException e ) {
     205:                     LOG.debug( "Not a String: " + varName );
     206:                 }
     207:             }
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 81, Column 21
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
      76:         final JspWriter out = pageContext.getOut();
      77:         String msg = null;
      78:         String value = null;
      79: 
      80:         try {
>>>   81:             value = engine.getManager( VariableManager.class ).getValue( m_wikiContext, getVar() );
      82:         } catch( final NoSuchVariableException e ) {
      83:             msg = "No such variable: " + e.getMessage();
      84:         } catch( final IllegalArgumentException e ) {
      85:             msg = "Incorrect variable name: " + e.getMessage();
      86:         }
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 95, Column 45
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
      90:         }
      91: 
      92:         if( value == null ) {
      93:             value = msg;
      94:         }
>>>   95:         out.write( TextUtil.replaceEntities(value) );
      96:         return SKIP_BODY;
      97:     }
      98: 
      99: }
```

### Data Flow Step 7: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     209:      *
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
>>>  214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
```

### Data Flow Step 8: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 23: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 24: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
>>>  220:         return src;
     221:     }
     222: 
     223:     /**
     224:      *  Replaces a string with another string.
     225:      *
```

### Data Flow Step 25: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 95, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
      90:         }
      91: 
      92:         if( value == null ) {
      93:             value = msg;
      94:         }
>>>   95:         out.write( TextUtil.replaceEntities(value) );
      96:         return SKIP_BODY;
      97:     }
      98: 
      99: }
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     468:      */
     469:     @Override
     470:     public String getHttpParameter( final String paramName ) {
     471:         String result = null;
     472:         if( m_request != null ) {
>>>  473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
     476:         return result;
     477:     }
     478: 
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     471:         String result = null;
     472:         if( m_request != null ) {
     473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
>>>  476:         return result;
     477:     }
     478: 
     479:     /**
     480:      *  If the request did originate from an HTTP request, then the HTTP request can be fetched here.  However, if the request
     481:      *  did NOT originate from an HTTP request, then this method will return null, and YOU SHOULD CHECK FOR IT!
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 200, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
     195: 
     196:                     if( s != null ) {
     197:                         return s;
     198:                     }
     199: 
>>>  200:                     s = context.getHttpParameter( varName );
     201:                     if( s != null ) {
     202:                         return s;
     203:                     }
     204:                 } catch( final ClassCastException e ) {
     205:                     LOG.debug( "Not a String: " + varName );
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 202, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
     197:                         return s;
     198:                     }
     199: 
     200:                     s = context.getHttpParameter( varName );
     201:                     if( s != null ) {
>>>  202:                         return s;
     203:                     }
     204:                 } catch( final ClassCastException e ) {
     205:                     LOG.debug( "Not a String: " + varName );
     206:                 }
     207:             }
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 81, Column 21
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
      76:         final JspWriter out = pageContext.getOut();
      77:         String msg = null;
      78:         String value = null;
      79: 
      80:         try {
>>>   81:             value = engine.getManager( VariableManager.class ).getValue( m_wikiContext, getVar() );
      82:         } catch( final NoSuchVariableException e ) {
      83:             msg = "No such variable: " + e.getMessage();
      84:         } catch( final IllegalArgumentException e ) {
      85:             msg = "Incorrect variable name: " + e.getMessage();
      86:         }
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 95, Column 45
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
      90:         }
      91: 
      92:         if( value == null ) {
      93:             value = msg;
      94:         }
>>>   95:         out.write( TextUtil.replaceEntities(value) );
      96:         return SKIP_BODY;
      97:     }
      98: 
      99: }
```

### Data Flow Step 7: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     209:      *
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
>>>  214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
```

### Data Flow Step 8: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 23: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 24: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 25: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 26: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 27: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 28: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 29: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 30: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 31: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 32: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 33: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 34: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 35: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 36: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
>>>  220:         return src;
     221:     }
     222: 
     223:     /**
     224:      *  Replaces a string with another string.
     225:      *
```

### Data Flow Step 37: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 95, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
      90:         }
      91: 
      92:         if( value == null ) {
      93:             value = msg;
      94:         }
>>>   95:         out.write( TextUtil.replaceEntities(value) );
      96:         return SKIP_BODY;
      97:     }
      98: 
      99: }
```
