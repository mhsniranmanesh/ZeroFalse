# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     468:      */
     469:     @Override
     470:     public String getHttpParameter( final String paramName ) {
     471:         String result = null;
     472:         if( m_request != null ) {
>>>  473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
     476:         return result;
     477:     }
     478: 
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     471:         String result = null;
     472:         if( m_request != null ) {
     473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
>>>  476:         return result;
     477:     }
     478: 
     479:     /**
     480:      *  If the request did originate from an HTTP request, then the HTTP request can be fetched here.  However, if the request
     481:      *  did NOT originate from an HTTP request, then this method will return null, and YOU SHOULD CHECK FOR IT!
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 200, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
     195: 
     196:                     if( s != null ) {
     197:                         return s;
     198:                     }
     199: 
>>>  200:                     s = context.getHttpParameter( varName );
     201:                     if( s != null ) {
     202:                         return s;
     203:                     }
     204:                 } catch( final ClassCastException e ) {
     205:                     LOG.debug( "Not a String: " + varName );
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 202, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
     197:                         return s;
     198:                     }
     199: 
     200:                     s = context.getHttpParameter( varName );
     201:                     if( s != null ) {
>>>  202:                         return s;
     203:                     }
     204:                 } catch( final ClassCastException e ) {
     205:                     LOG.debug( "Not a String: " + varName );
     206:                 }
     207:             }
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java, Line 63, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java
```java
      58:         final Engine engine = context.getEngine();
      59: 
      60:         String blogname = null;
      61: 
      62:         try {
>>>   63:             blogname = engine.getManager( VariableManager.class ).getValue(context, VAR_BLOGNAME);
      64:         } catch( final NoSuchVariableException e ) {
      65:         }
      66: 
      67:         if (blogname == null) {
      68:             blogname = engine.getApplicationName() + ": " + context.getPage().getName();
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java, Line 71, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java
```java
      66: 
      67:         if (blogname == null) {
      68:             blogname = engine.getApplicationName() + ": " + context.getPage().getName();
      69:         }
      70: 
>>>   71:         return blogname;
      72:     }
      73: 
      74:     /**
      75:      * Create a new Feed for a particular WikiContext.
      76:      *
```

### Data Flow Step 7: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 49, Column 31
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
      44:         final String encodedName = engine.encodeName( page.getName() );
      45:         final String rssURL      = engine.getGlobalRSSURL();
      46:         final String rssFeedURL  = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(), "rss.jsp","page="+encodedName+"&amp;mode=wiki" );
      47: 
      48:         if( rssURL != null ) {
>>>   49:             String siteName = Feed.getSiteName(m_wikiContext);
      50:             siteName = TextUtil.replaceEntities( siteName );
      51: 
      52:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for the entire site.\" href=\""+rssURL+"\" />\n");
      53:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for page "+siteName+".\" href=\""+rssFeedURL+"\" />\n");
      54: 
```

### Data Flow Step 8: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 50, Column 50
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
      45:         final String rssURL      = engine.getGlobalRSSURL();
      46:         final String rssFeedURL  = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(), "rss.jsp","page="+encodedName+"&amp;mode=wiki" );
      47: 
      48:         if( rssURL != null ) {
      49:             String siteName = Feed.getSiteName(m_wikiContext);
>>>   50:             siteName = TextUtil.replaceEntities( siteName );
      51: 
      52:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for the entire site.\" href=\""+rssURL+"\" />\n");
      53:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for page "+siteName+".\" href=\""+rssFeedURL+"\" />\n");
      54: 
      55:             // TODO: Enable this
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     209:      *
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
>>>  214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 23: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 24: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
>>>  239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
```

### Data Flow Step 25: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 26: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
>>>  220:         return src;
     221:     }
     222: 
     223:     /**
     224:      *  Replaces a string with another string.
     225:      *
```

### Data Flow Step 27: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 50, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
      45:         final String rssURL      = engine.getGlobalRSSURL();
      46:         final String rssFeedURL  = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(), "rss.jsp","page="+encodedName+"&amp;mode=wiki" );
      47: 
      48:         if( rssURL != null ) {
      49:             String siteName = Feed.getSiteName(m_wikiContext);
>>>   50:             siteName = TextUtil.replaceEntities( siteName );
      51: 
      52:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for the entire site.\" href=\""+rssURL+"\" />\n");
      53:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for page "+siteName+".\" href=\""+rssFeedURL+"\" />\n");
      54: 
      55:             // TODO: Enable this
```

### Data Flow Step 28: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 68, Column 44
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
      63:                 final String atomFeedURL = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(),"rss.jsp","page="+encodedName+"&amp;type=atom" );
      64: 
      65:                 pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS feed for weblog "+
      66:                                            siteName+".\" href=\""+blogFeedURL+"\" />\n");
      67: 
>>>   68:                 pageContext.getOut().print("<link rel=\"service.feed\" type=\"application/atom+xml\" title=\"Atom 1.0 weblog feed for "+
      69:                                            siteName+"\" href=\""+atomFeedURL+"\" />\n");
      70:             }
      71:         }
      72: 
      73:         return SKIP_BODY;
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     468:      */
     469:     @Override
     470:     public String getHttpParameter( final String paramName ) {
     471:         String result = null;
     472:         if( m_request != null ) {
>>>  473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
     476:         return result;
     477:     }
     478: 
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
     471:         String result = null;
     472:         if( m_request != null ) {
     473:             result = m_request.getParameter( paramName );
     474:         }
     475: 
>>>  476:         return result;
     477:     }
     478: 
     479:     /**
     480:      *  If the request did originate from an HTTP request, then the HTTP request can be fetched here.  However, if the request
     481:      *  did NOT originate from an HTTP request, then this method will return null, and YOU SHOULD CHECK FOR IT!
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 200, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
     195: 
     196:                     if( s != null ) {
     197:                         return s;
     198:                     }
     199: 
>>>  200:                     s = context.getHttpParameter( varName );
     201:                     if( s != null ) {
     202:                         return s;
     203:                     }
     204:                 } catch( final ClassCastException e ) {
     205:                     LOG.debug( "Not a String: " + varName );
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 202, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
     197:                         return s;
     198:                     }
     199: 
     200:                     s = context.getHttpParameter( varName );
     201:                     if( s != null ) {
>>>  202:                         return s;
     203:                     }
     204:                 } catch( final ClassCastException e ) {
     205:                     LOG.debug( "Not a String: " + varName );
     206:                 }
     207:             }
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java, Line 63, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java
```java
      58:         final Engine engine = context.getEngine();
      59: 
      60:         String blogname = null;
      61: 
      62:         try {
>>>   63:             blogname = engine.getManager( VariableManager.class ).getValue(context, VAR_BLOGNAME);
      64:         } catch( final NoSuchVariableException e ) {
      65:         }
      66: 
      67:         if (blogname == null) {
      68:             blogname = engine.getApplicationName() + ": " + context.getPage().getName();
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java, Line 71, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java
```java
      66: 
      67:         if (blogname == null) {
      68:             blogname = engine.getApplicationName() + ": " + context.getPage().getName();
      69:         }
      70: 
>>>   71:         return blogname;
      72:     }
      73: 
      74:     /**
      75:      * Create a new Feed for a particular WikiContext.
      76:      *
```

### Data Flow Step 7: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 49, Column 31
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
      44:         final String encodedName = engine.encodeName( page.getName() );
      45:         final String rssURL      = engine.getGlobalRSSURL();
      46:         final String rssFeedURL  = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(), "rss.jsp","page="+encodedName+"&amp;mode=wiki" );
      47: 
      48:         if( rssURL != null ) {
>>>   49:             String siteName = Feed.getSiteName(m_wikiContext);
      50:             siteName = TextUtil.replaceEntities( siteName );
      51: 
      52:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for the entire site.\" href=\""+rssURL+"\" />\n");
      53:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for page "+siteName+".\" href=\""+rssFeedURL+"\" />\n");
      54: 
```

### Data Flow Step 8: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 50, Column 50
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
      45:         final String rssURL      = engine.getGlobalRSSURL();
      46:         final String rssFeedURL  = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(), "rss.jsp","page="+encodedName+"&amp;mode=wiki" );
      47: 
      48:         if( rssURL != null ) {
      49:             String siteName = Feed.getSiteName(m_wikiContext);
>>>   50:             siteName = TextUtil.replaceEntities( siteName );
      51: 
      52:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for the entire site.\" href=\""+rssURL+"\" />\n");
      53:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for page "+siteName+".\" href=\""+rssFeedURL+"\" />\n");
      54: 
      55:             // TODO: Enable this
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     209:      *
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
>>>  214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     210:      *  @since 1.6.1
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
>>>  215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 23: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     211:      *  @param src The source string.
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
>>>  216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
```

### Data Flow Step 24: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 25: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 26: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 27: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 28: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 29: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 30: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     212:      *  @return The encoded string.
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
>>>  217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
```

### Data Flow Step 31: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 32: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     226:      *  @param orig Original string.  Null is safe.
     227:      *  @param src  The string to find.
     228:      *  @param dest The string to replace <I>src</I> with.
     229:      *  @return A string with the replacement done.
     230:      */
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
```

### Data Flow Step 33: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 34: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
>>>  248:             res.append( orig, last, start );
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
```

### Data Flow Step 35: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 36: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
>>>  255:         return res.toString();
     256:     }
     257: 
     258:     /**
     259:      *  Replaces a part of a string with a new String.
     260:      *
```

### Data Flow Step 37: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     213:      */
     214:     public static String replaceEntities( String src ) {
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
>>>  218:         src = replaceString( src, "\"", "&quot;" );
     219: 
     220:         return src;
     221:     }
     222: 
     223:     /**
```

### Data Flow Step 38: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
     215:         src = replaceString( src, "&", "&amp;" );
     216:         src = replaceString( src, "<", "&lt;" );
     217:         src = replaceString( src, ">", "&gt;" );
     218:         src = replaceString( src, "\"", "&quot;" );
     219: 
>>>  220:         return src;
     221:     }
     222: 
     223:     /**
     224:      *  Replaces a string with another string.
     225:      *
```

### Data Flow Step 39: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 50, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
      45:         final String rssURL      = engine.getGlobalRSSURL();
      46:         final String rssFeedURL  = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(), "rss.jsp","page="+encodedName+"&amp;mode=wiki" );
      47: 
      48:         if( rssURL != null ) {
      49:             String siteName = Feed.getSiteName(m_wikiContext);
>>>   50:             siteName = TextUtil.replaceEntities( siteName );
      51: 
      52:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for the entire site.\" href=\""+rssURL+"\" />\n");
      53:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for page "+siteName+".\" href=\""+rssFeedURL+"\" />\n");
      54: 
      55:             // TODO: Enable this
```

### Data Flow Step 40: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 68, Column 44
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
      63:                 final String atomFeedURL = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(),"rss.jsp","page="+encodedName+"&amp;type=atom" );
      64: 
      65:                 pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS feed for weblog "+
      66:                                            siteName+".\" href=\""+blogFeedURL+"\" />\n");
      67: 
>>>   68:                 pageContext.getOut().print("<link rel=\"service.feed\" type=\"application/atom+xml\" title=\"Atom 1.0 weblog feed for "+
      69:                                            siteName+"\" href=\""+atomFeedURL+"\" />\n");
      70:             }
      71:         }
      72: 
      73:         return SKIP_BODY;
```
