# Vulnerability: java/zipslip
## Message: Unsanitized archive entry, which may contain '..', is used in a [file system operation](1).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](2).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: core/src/main/java/org/owasp/dependencycheck/utils/ExtractionUtil.java, Line 168, Column 60
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/utils/ExtractionUtil.java
```java
     163:             throws ArchiveExtractionException {
     164:         ArchiveEntry entry;
     165:         try {
     166:             while ((entry = input.getNextEntry()) != null) {
     167:                 if (entry.isDirectory()) {
>>>  168:                     final File dir = new File(destination, entry.getName());
     169:                     if (!dir.exists() && !dir.mkdirs()) {
     170:                         final String msg = String.format(
     171:                                 "Unable to create directory '%s'.",
     172:                                 dir.getAbsolutePath());
     173:                         throw new AnalysisException(msg);
```

### Data Flow Step 2: core/src/main/java/org/owasp/dependencycheck/utils/ExtractionUtil.java, Line 169, Column 26
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/utils/ExtractionUtil.java
```java
     164:         ArchiveEntry entry;
     165:         try {
     166:             while ((entry = input.getNextEntry()) != null) {
     167:                 if (entry.isDirectory()) {
     168:                     final File dir = new File(destination, entry.getName());
>>>  169:                     if (!dir.exists() && !dir.mkdirs()) {
     170:                         final String msg = String.format(
     171:                                 "Unable to create directory '%s'.",
     172:                                 dir.getAbsolutePath());
     173:                         throw new AnalysisException(msg);
     174:                     }
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: core/src/main/java/org/owasp/dependencycheck/utils/ExtractionUtil.java, Line 168, Column 60
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/utils/ExtractionUtil.java
```java
     163:             throws ArchiveExtractionException {
     164:         ArchiveEntry entry;
     165:         try {
     166:             while ((entry = input.getNextEntry()) != null) {
     167:                 if (entry.isDirectory()) {
>>>  168:                     final File dir = new File(destination, entry.getName());
     169:                     if (!dir.exists() && !dir.mkdirs()) {
     170:                         final String msg = String.format(
     171:                                 "Unable to create directory '%s'.",
     172:                                 dir.getAbsolutePath());
     173:                         throw new AnalysisException(msg);
```

### Data Flow Step 2: core/src/main/java/org/owasp/dependencycheck/utils/ExtractionUtil.java, Line 169, Column 43
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/utils/ExtractionUtil.java
```java
     164:         ArchiveEntry entry;
     165:         try {
     166:             while ((entry = input.getNextEntry()) != null) {
     167:                 if (entry.isDirectory()) {
     168:                     final File dir = new File(destination, entry.getName());
>>>  169:                     if (!dir.exists() && !dir.mkdirs()) {
     170:                         final String msg = String.format(
     171:                                 "Unable to create directory '%s'.",
     172:                                 dir.getAbsolutePath());
     173:                         throw new AnalysisException(msg);
     174:                     }
```
