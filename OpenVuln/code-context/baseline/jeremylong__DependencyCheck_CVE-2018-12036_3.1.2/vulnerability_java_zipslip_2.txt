# Vulnerability: java/zipslip
## Message: Unsanitized archive entry, which may contain '..', is used in a [file system operation](1).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](2).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](3).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](4).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](5).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 516, Column 57
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     511:      */
     512:     private void extractArchive(ArchiveInputStream input, File destination, Engine engine) throws ArchiveExtractionException {
     513:         ArchiveEntry entry;
     514:         try {
     515:             while ((entry = input.getNextEntry()) != null) {
>>>  516:                 final File file = new File(destination, entry.getName());
     517:                 if (entry.isDirectory()) {
     518:                     if (!file.exists() && !file.mkdirs()) {
     519:                         final String msg = String.format("Unable to create directory '%s'.", file.getAbsolutePath());
     520:                         throw new AnalysisException(msg);
     521:                     }
```

### Data Flow Step 2: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 518, Column 26
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     513:         ArchiveEntry entry;
     514:         try {
     515:             while ((entry = input.getNextEntry()) != null) {
     516:                 final File file = new File(destination, entry.getName());
     517:                 if (entry.isDirectory()) {
>>>  518:                     if (!file.exists() && !file.mkdirs()) {
     519:                         final String msg = String.format("Unable to create directory '%s'.", file.getAbsolutePath());
     520:                         throw new AnalysisException(msg);
     521:                     }
     522:                 } else if (engine.accept(file)) {
     523:                     extractAcceptedFile(input, file);
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 516, Column 57
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     511:      */
     512:     private void extractArchive(ArchiveInputStream input, File destination, Engine engine) throws ArchiveExtractionException {
     513:         ArchiveEntry entry;
     514:         try {
     515:             while ((entry = input.getNextEntry()) != null) {
>>>  516:                 final File file = new File(destination, entry.getName());
     517:                 if (entry.isDirectory()) {
     518:                     if (!file.exists() && !file.mkdirs()) {
     519:                         final String msg = String.format("Unable to create directory '%s'.", file.getAbsolutePath());
     520:                         throw new AnalysisException(msg);
     521:                     }
```

### Data Flow Step 2: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 518, Column 44
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     513:         ArchiveEntry entry;
     514:         try {
     515:             while ((entry = input.getNextEntry()) != null) {
     516:                 final File file = new File(destination, entry.getName());
     517:                 if (entry.isDirectory()) {
>>>  518:                     if (!file.exists() && !file.mkdirs()) {
     519:                         final String msg = String.format("Unable to create directory '%s'.", file.getAbsolutePath());
     520:                         throw new AnalysisException(msg);
     521:                     }
     522:                 } else if (engine.accept(file)) {
     523:                     extractAcceptedFile(input, file);
```

## Code Flow 3

### Thread Flow 1

### Data Flow Step 1: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 516, Column 57
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     511:      */
     512:     private void extractArchive(ArchiveInputStream input, File destination, Engine engine) throws ArchiveExtractionException {
     513:         ArchiveEntry entry;
     514:         try {
     515:             while ((entry = input.getNextEntry()) != null) {
>>>  516:                 final File file = new File(destination, entry.getName());
     517:                 if (entry.isDirectory()) {
     518:                     if (!file.exists() && !file.mkdirs()) {
     519:                         final String msg = String.format("Unable to create directory '%s'.", file.getAbsolutePath());
     520:                         throw new AnalysisException(msg);
     521:                     }
```

### Data Flow Step 2: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 523, Column 48
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     518:                     if (!file.exists() && !file.mkdirs()) {
     519:                         final String msg = String.format("Unable to create directory '%s'.", file.getAbsolutePath());
     520:                         throw new AnalysisException(msg);
     521:                     }
     522:                 } else if (engine.accept(file)) {
>>>  523:                     extractAcceptedFile(input, file);
     524:                 }
     525:             }
     526:         } catch (IOException | AnalysisException ex) {
     527:             throw new ArchiveExtractionException(ex);
     528:         } finally {
```

### Data Flow Step 3: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 540, Column 71
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     535:      *
     536:      * @param input the archives input stream
     537:      * @param file the file to extract
     538:      * @throws AnalysisException thrown if there is an error
     539:      */
>>>  540:     private static void extractAcceptedFile(ArchiveInputStream input, File file) throws AnalysisException {
     541:         LOGGER.debug("Extracting '{}'", file.getPath());
     542:         final File parent = file.getParentFile();
     543:         if (!parent.isDirectory() && !parent.mkdirs()) {
     544:             final String msg = String.format("Unable to build directory '%s'.", parent.getAbsolutePath());
     545:             throw new AnalysisException(msg);
```

### Data Flow Step 4: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 542, Column 29
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     537:      * @param file the file to extract
     538:      * @throws AnalysisException thrown if there is an error
     539:      */
     540:     private static void extractAcceptedFile(ArchiveInputStream input, File file) throws AnalysisException {
     541:         LOGGER.debug("Extracting '{}'", file.getPath());
>>>  542:         final File parent = file.getParentFile();
     543:         if (!parent.isDirectory() && !parent.mkdirs()) {
     544:             final String msg = String.format("Unable to build directory '%s'.", parent.getAbsolutePath());
     545:             throw new AnalysisException(msg);
     546:         }
     547:         try (FileOutputStream fos = new FileOutputStream(file)) {
```

### Data Flow Step 5: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 542, Column 29
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     537:      * @param file the file to extract
     538:      * @throws AnalysisException thrown if there is an error
     539:      */
     540:     private static void extractAcceptedFile(ArchiveInputStream input, File file) throws AnalysisException {
     541:         LOGGER.debug("Extracting '{}'", file.getPath());
>>>  542:         final File parent = file.getParentFile();
     543:         if (!parent.isDirectory() && !parent.mkdirs()) {
     544:             final String msg = String.format("Unable to build directory '%s'.", parent.getAbsolutePath());
     545:             throw new AnalysisException(msg);
     546:         }
     547:         try (FileOutputStream fos = new FileOutputStream(file)) {
```

### Data Flow Step 6: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 543, Column 14
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     538:      * @throws AnalysisException thrown if there is an error
     539:      */
     540:     private static void extractAcceptedFile(ArchiveInputStream input, File file) throws AnalysisException {
     541:         LOGGER.debug("Extracting '{}'", file.getPath());
     542:         final File parent = file.getParentFile();
>>>  543:         if (!parent.isDirectory() && !parent.mkdirs()) {
     544:             final String msg = String.format("Unable to build directory '%s'.", parent.getAbsolutePath());
     545:             throw new AnalysisException(msg);
     546:         }
     547:         try (FileOutputStream fos = new FileOutputStream(file)) {
     548:             IOUtils.copy(input, fos);
```

## Code Flow 4

### Thread Flow 1

### Data Flow Step 1: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 516, Column 57
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     511:      */
     512:     private void extractArchive(ArchiveInputStream input, File destination, Engine engine) throws ArchiveExtractionException {
     513:         ArchiveEntry entry;
     514:         try {
     515:             while ((entry = input.getNextEntry()) != null) {
>>>  516:                 final File file = new File(destination, entry.getName());
     517:                 if (entry.isDirectory()) {
     518:                     if (!file.exists() && !file.mkdirs()) {
     519:                         final String msg = String.format("Unable to create directory '%s'.", file.getAbsolutePath());
     520:                         throw new AnalysisException(msg);
     521:                     }
```

### Data Flow Step 2: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 523, Column 48
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     518:                     if (!file.exists() && !file.mkdirs()) {
     519:                         final String msg = String.format("Unable to create directory '%s'.", file.getAbsolutePath());
     520:                         throw new AnalysisException(msg);
     521:                     }
     522:                 } else if (engine.accept(file)) {
>>>  523:                     extractAcceptedFile(input, file);
     524:                 }
     525:             }
     526:         } catch (IOException | AnalysisException ex) {
     527:             throw new ArchiveExtractionException(ex);
     528:         } finally {
```

### Data Flow Step 3: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 540, Column 71
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     535:      *
     536:      * @param input the archives input stream
     537:      * @param file the file to extract
     538:      * @throws AnalysisException thrown if there is an error
     539:      */
>>>  540:     private static void extractAcceptedFile(ArchiveInputStream input, File file) throws AnalysisException {
     541:         LOGGER.debug("Extracting '{}'", file.getPath());
     542:         final File parent = file.getParentFile();
     543:         if (!parent.isDirectory() && !parent.mkdirs()) {
     544:             final String msg = String.format("Unable to build directory '%s'.", parent.getAbsolutePath());
     545:             throw new AnalysisException(msg);
```

### Data Flow Step 4: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 542, Column 29
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     537:      * @param file the file to extract
     538:      * @throws AnalysisException thrown if there is an error
     539:      */
     540:     private static void extractAcceptedFile(ArchiveInputStream input, File file) throws AnalysisException {
     541:         LOGGER.debug("Extracting '{}'", file.getPath());
>>>  542:         final File parent = file.getParentFile();
     543:         if (!parent.isDirectory() && !parent.mkdirs()) {
     544:             final String msg = String.format("Unable to build directory '%s'.", parent.getAbsolutePath());
     545:             throw new AnalysisException(msg);
     546:         }
     547:         try (FileOutputStream fos = new FileOutputStream(file)) {
```

### Data Flow Step 5: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 542, Column 29
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     537:      * @param file the file to extract
     538:      * @throws AnalysisException thrown if there is an error
     539:      */
     540:     private static void extractAcceptedFile(ArchiveInputStream input, File file) throws AnalysisException {
     541:         LOGGER.debug("Extracting '{}'", file.getPath());
>>>  542:         final File parent = file.getParentFile();
     543:         if (!parent.isDirectory() && !parent.mkdirs()) {
     544:             final String msg = String.format("Unable to build directory '%s'.", parent.getAbsolutePath());
     545:             throw new AnalysisException(msg);
     546:         }
     547:         try (FileOutputStream fos = new FileOutputStream(file)) {
```

### Data Flow Step 6: core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java, Line 543, Column 39
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/ArchiveAnalyzer.java
```java
     538:      * @throws AnalysisException thrown if there is an error
     539:      */
     540:     private static void extractAcceptedFile(ArchiveInputStream input, File file) throws AnalysisException {
     541:         LOGGER.debug("Extracting '{}'", file.getPath());
     542:         final File parent = file.getParentFile();
>>>  543:         if (!parent.isDirectory() && !parent.mkdirs()) {
     544:             final String msg = String.format("Unable to build directory '%s'.", parent.getAbsolutePath());
     545:             throw new AnalysisException(msg);
     546:         }
     547:         try (FileOutputStream fos = new FileOutputStream(file)) {
     548:             IOUtils.copy(input, fos);
```
