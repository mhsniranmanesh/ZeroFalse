# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).
Cross-site scripting vulnerability due to a [user-provided value](2).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: services/src/main/java/org/keycloak/theme/ClassLoaderTheme.java, Line 125, Column 20
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/ClassLoaderTheme.java
```java
>>>  125:             return resourceURL.openConnection().getInputStream();
```

### Data Flow Step 2: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 71, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   71:                 resource = theme.getResourceAsStream(path);
```

**Intermediate code within method `getResource` (lines 72-74):**
```java
      72:             }
      73: 
      74:             if (resource != null) {
      75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 3: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 59
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 4: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 5: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 6: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

**Intermediate code within method `getResource` (lines 76-78):**
```java
      76:                 if (encodingProvider != null) {
      77:                     rb.encoding(encodingProvider.getEncoding());
      78:                 }
      79:                 return rb.build();
```

### Data Flow Step 7: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 79, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   79:                 return rb.build();
```

### Data Flow Step 8: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 79, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   79:                 return rb.build();
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: services/src/main/java/org/keycloak/theme/ClassLoaderTheme.java, Line 125, Column 20
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/ClassLoaderTheme.java
```java
>>>  125:             return resourceURL.openConnection().getInputStream();
```

### Data Flow Step 2: services/src/main/java/org/keycloak/theme/DefaultThemeManager.java, Line 210, Column 40
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/DefaultThemeManager.java
```java
>>>  210:                 InputStream resource = t.getResourceAsStream(path);
```

**Intermediate code within method `getResourceAsStream` (lines 211-211):**
```java
     211:                 if (resource != null) {
     212:                     return resource;
```

### Data Flow Step 3: services/src/main/java/org/keycloak/theme/DefaultThemeManager.java, Line 212, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/DefaultThemeManager.java
```java
>>>  212:                     return resource;
```

### Data Flow Step 4: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 71, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   71:                 resource = theme.getResourceAsStream(path);
```

**Intermediate code within method `getResource` (lines 72-74):**
```java
      72:             }
      73: 
      74:             if (resource != null) {
      75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 5: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 59
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 6: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 7: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 8: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

**Intermediate code within method `getResource` (lines 76-78):**
```java
      76:                 if (encodingProvider != null) {
      77:                     rb.encoding(encodingProvider.getEncoding());
      78:                 }
      79:                 return rb.build();
```

### Data Flow Step 9: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 79, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   79:                 return rb.build();
```

### Data Flow Step 10: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 79, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   79:                 return rb.build();
```

## Code Flow 3

### Thread Flow 1

### Data Flow Step 1: services/src/main/java/org/keycloak/theme/ClasspathThemeResourceProviderFactory.java, Line 60, Column 20
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/ClasspathThemeResourceProviderFactory.java
```java
>>>   60:             return resourceURL.openConnection().getInputStream();
```

### Data Flow Step 2: services/src/main/java/org/keycloak/theme/ClasspathThemeResourceProviderFactory.java, Line 47, Column 16
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/ClasspathThemeResourceProviderFactory.java
```java
>>>   47:         return getResourceAsStream(path, classLoader.getResource(THEME_RESOURCES_RESOURCES));
```

### Data Flow Step 3: services/src/main/java/org/keycloak/theme/DefaultThemeManager.java, Line 217, Column 40
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/DefaultThemeManager.java
```java
>>>  217:                 InputStream resource = t.getResourceAsStream(path);
```

**Intermediate code within method `getResourceAsStream` (lines 218-218):**
```java
     218:                 if (resource != null) {
     219:                     return resource;
```

### Data Flow Step 4: services/src/main/java/org/keycloak/theme/DefaultThemeManager.java, Line 219, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/DefaultThemeManager.java
```java
>>>  219:                     return resource;
```

### Data Flow Step 5: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 71, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   71:                 resource = theme.getResourceAsStream(path);
```

**Intermediate code within method `getResource` (lines 72-74):**
```java
      72:             }
      73: 
      74:             if (resource != null) {
      75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 6: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 59
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 7: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 8: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 9: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

**Intermediate code within method `getResource` (lines 76-78):**
```java
      76:                 if (encodingProvider != null) {
      77:                     rb.encoding(encodingProvider.getEncoding());
      78:                 }
      79:                 return rb.build();
```

### Data Flow Step 10: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 79, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   79:                 return rb.build();
```

### Data Flow Step 11: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 79, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   79:                 return rb.build();
```

## Code Flow 4

### Thread Flow 1

### Data Flow Step 1: services/src/main/java/org/keycloak/theme/ClasspathThemeResourceProviderFactory.java, Line 60, Column 20
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/ClasspathThemeResourceProviderFactory.java
```java
>>>   60:             return resourceURL.openConnection().getInputStream();
```

### Data Flow Step 2: quarkus/runtime/src/main/java/org/keycloak/quarkus/runtime/themes/FlatClasspathThemeResourceProviderFactory.java, Line 37, Column 30
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/quarkus/runtime/src/main/java/org/keycloak/quarkus/runtime/themes/FlatClasspathThemeResourceProviderFactory.java
```java
>>>   37:             InputStream is = getResourceAsStream(path, resources.nextElement());
```

**Intermediate code within method `getResourceAsStream` (lines 38-39):**
```java
      38: 
      39:             if (is != null) {
      40:                 return is;
```

### Data Flow Step 3: quarkus/runtime/src/main/java/org/keycloak/quarkus/runtime/themes/FlatClasspathThemeResourceProviderFactory.java, Line 40, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/quarkus/runtime/src/main/java/org/keycloak/quarkus/runtime/themes/FlatClasspathThemeResourceProviderFactory.java
```java
>>>   40:                 return is;
```

### Data Flow Step 4: services/src/main/java/org/keycloak/theme/DefaultThemeManager.java, Line 217, Column 40
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/DefaultThemeManager.java
```java
>>>  217:                 InputStream resource = t.getResourceAsStream(path);
```

**Intermediate code within method `getResourceAsStream` (lines 218-218):**
```java
     218:                 if (resource != null) {
     219:                     return resource;
```

### Data Flow Step 5: services/src/main/java/org/keycloak/theme/DefaultThemeManager.java, Line 219, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/theme/DefaultThemeManager.java
```java
>>>  219:                     return resource;
```

### Data Flow Step 6: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 71, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   71:                 resource = theme.getResourceAsStream(path);
```

**Intermediate code within method `getResource` (lines 72-74):**
```java
      72:             }
      73: 
      74:             if (resource != null) {
      75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 7: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 59
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 8: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 9: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

### Data Flow Step 10: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 75, Column 47
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   75:                 Response.ResponseBuilder rb = Response.ok(resource).type(contentType).cacheControl(CacheControlUtil.getDefaultCacheControl());
```

**Intermediate code within method `getResource` (lines 76-78):**
```java
      76:                 if (encodingProvider != null) {
      77:                     rb.encoding(encodingProvider.getEncoding());
      78:                 }
      79:                 return rb.build();
```

### Data Flow Step 11: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 79, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   79:                 return rb.build();
```

### Data Flow Step 12: services/src/main/java/org/keycloak/services/resources/ThemeResource.java, Line 79, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/services/src/main/java/org/keycloak/services/resources/ThemeResource.java
```java
>>>   79:                 return rb.build();
```
