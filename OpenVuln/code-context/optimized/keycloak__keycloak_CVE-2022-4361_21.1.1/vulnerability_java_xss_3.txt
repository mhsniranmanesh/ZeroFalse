# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).
Cross-site scripting vulnerability due to a [user-provided value](2).
Cross-site scripting vulnerability due to a [user-provided value](3).
Cross-site scripting vulnerability due to a [user-provided value](4).
Cross-site scripting vulnerability due to a [user-provided value](5).
Cross-site scripting vulnerability due to a [user-provided value](6).
Cross-site scripting vulnerability due to a [user-provided value](7).
Cross-site scripting vulnerability due to a [user-provided value](8).
Cross-site scripting vulnerability due to a [user-provided value](9).
Cross-site scripting vulnerability due to a [user-provided value](10).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java, Line 49, Column 52
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java
```java
>>>   49:             Map body = JsonSerialization.readValue(request.getInputStream(), Map.class);
```

### Data Flow Step 2: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 78, Column 35
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
>>>   78:     public static <T> T readValue(InputStream bytes, Class<T> type) throws IOException {
```

### Data Flow Step 3: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 79, Column 26
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
>>>   79:         return readValue(bytes, type, false);
```

### Data Flow Step 4: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 90, Column 35
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
>>>   90:     public static <T> T readValue(InputStream bytes, Class<T> type, boolean replaceSystemProperties) throws IOException {
```

**Intermediate code within method `readValue` (lines 91-93):**
```java
      91:         if (replaceSystemProperties) {
      92:             return sysPropertiesAwareMapper.readValue(bytes, type);
      93:         } else {
      94:             return mapper.readValue(bytes, type);
```

### Data Flow Step 5: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 94, Column 20
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
>>>   94:             return mapper.readValue(bytes, type);
```

### Data Flow Step 6: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 79, Column 16
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
>>>   79:         return readValue(bytes, type, false);
```

### Data Flow Step 7: testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java, Line 49, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java
```java
>>>   49:             Map body = JsonSerialization.readValue(request.getInputStream(), Map.class);
```

**Intermediate code within method `doFilter` (lines 50-51):**
```java
      50:             response.setContentType("application/json");
      51:             PrintWriter writer = response.getWriter();
      52:             writer.println(JsonSerialization.writeValueAsString(body));
```

### Data Flow Step 8: testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java, Line 52, Column 65
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java
```java
>>>   52:             writer.println(JsonSerialization.writeValueAsString(body));
```

### Data Flow Step 9: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 62, Column 45
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
>>>   62:     public static String writeValueAsString(Object obj) throws IOException {
```

### Data Flow Step 10: core/src/main/java/org/keycloak/util/JsonSerialization.java, Line 63, Column 16
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/core/src/main/java/org/keycloak/util/JsonSerialization.java
```java
>>>   63:         return mapper.writeValueAsString(obj);
```

### Data Flow Step 11: testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java, Line 52, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlet-authz/src/main/java/org/keycloak/testsuite/servletauthz/TestFilter.java
```java
>>>   52:             writer.println(JsonSerialization.writeValueAsString(body));
```

### Data Flow Step 12: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 33, Column 25
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
>>>   33:     public void println(String x) {
```

### Data Flow Step 13: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 34, Column 23
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
>>>   34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 78, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
>>>   78:             String error = request.getParameter("link_error");
```

**Intermediate code within method `doGet` (lines 79-79):**
```java
      79:             if (error != null) {
      80:                 pw.println("Link error: " + error);
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 80, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
>>>   80:                 pw.println("Link error: " + error);
```

### Data Flow Step 3: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 33, Column 25
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
>>>   33:     public void println(String x) {
```

### Data Flow Step 4: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 34, Column 23
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
>>>   34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
```

## Code Flow 3

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 91, Column 46
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
>>>   91:             pw.println("Unknown request: " + request.getRequestURL().toString());
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 91, Column 46
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
>>>   91:             pw.println("Unknown request: " + request.getRequestURL().toString());
```

### Data Flow Step 3: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java, Line 91, Column 24
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/ClientInitiatedAccountLinkServlet.java
```java
>>>   91:             pw.println("Unknown request: " + request.getRequestURL().toString());
```

### Data Flow Step 4: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 33, Column 25
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
>>>   33:     public void println(String x) {
```

### Data Flow Step 5: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 34, Column 23
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
>>>   34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
```

## Code Flow 4

### Thread Flow 1

### Data Flow Step 1: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 61, Column 78
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
>>>   61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
```

### Data Flow Step 2: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 61, Column 56
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
>>>   61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
```

### Data Flow Step 3: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 61, Column 37
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
>>>   61:                 BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
```

**Intermediate code within method `doGet` (lines 62-62):**
```java
      62:                 String line;
      63:                 while ((line = rd.readLine()) != null) {
```

### Data Flow Step 4: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 63, Column 32
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
>>>   63:                 while ((line = rd.readLine()) != null) {
```

### Data Flow Step 5: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 63, Column 32
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
>>>   63:                 while ((line = rd.readLine()) != null) {
```

### Data Flow Step 6: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 64, Column 35
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
>>>   64:                     result.append(line);
```

### Data Flow Step 7: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 64, Column 21
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
>>>   64:                     result.append(line);
```

**Intermediate code within method `doGet` (lines 65-66):**
```java
      65:                 }
      66:                 rd.close();
      67:                 pw.println(result.toString());
```

### Data Flow Step 8: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 67, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
>>>   67:                 pw.println(result.toString());
```

### Data Flow Step 9: testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java, Line 67, Column 28
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/testsuite/integration-arquillian/test-apps/servlets/src/main/java/org/keycloak/testsuite/adapter/servlet/CustomerServlet.java
```java
>>>   67:                 pw.println(result.toString());
```

### Data Flow Step 10: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 33, Column 25
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
>>>   33:     public void println(String x) {
```

### Data Flow Step 11: model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java, Line 34, Column 23
File: codeql-dbs/keycloak__keycloak_CVE-2022-4361_21.1.1/root/cwe-bench-java/project-sources/keycloak__keycloak_CVE-2022-4361_21.1.1/model/build-processor/src/main/java/org/keycloak/models/map/processor/PrintWriterNoJavaLang.java
```java
>>>   34:         super.println(x == null ? x : x.replaceAll("java.lang.", ""));
```
