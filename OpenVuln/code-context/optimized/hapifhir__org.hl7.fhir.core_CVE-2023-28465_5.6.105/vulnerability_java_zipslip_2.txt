# Vulnerability: java/zipslip
## Message: Unsanitized archive entry, which may contain '..', is used in a [file system operation](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/Scanner.java, Line 344, Column 58
File: codeql-dbs/hapifhir__org.hl7.fhir.core_CVE-2023-28465_5.6.105/root/cwe-bench-java/project-sources/hapifhir__org.hl7.fhir.core_CVE-2023-28465_5.6.105/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/Scanner.java
```java
>>>  344:       String filePath = destDirectory + File.separator + entry.getName();
```

**Intermediate code within method `unzip` (lines 345-352):**
```java
     345: 
     346:       final File zipEntryFile = new File(destDirectory, entry.getName());
     347:       if (!zipEntryFile.toPath().normalize().startsWith(destDirectory)) {
     348:         throw new RuntimeException("Entry with an illegal path: " + entry.getName());
     349:       }
     350: 
     351:       if (!entry.isDirectory()) {
     352:         // if the entry is a file, extract it
     353:         extractFile(zipIn, filePath);
```

### Data Flow Step 2: org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/Scanner.java, Line 353, Column 28
File: codeql-dbs/hapifhir__org.hl7.fhir.core_CVE-2023-28465_5.6.105/root/cwe-bench-java/project-sources/hapifhir__org.hl7.fhir.core_CVE-2023-28465_5.6.105/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/Scanner.java
```java
>>>  353:         extractFile(zipIn, filePath);
```

### Data Flow Step 3: org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/Scanner.java, Line 364, Column 52
File: codeql-dbs/hapifhir__org.hl7.fhir.core_CVE-2023-28465_5.6.105/root/cwe-bench-java/project-sources/hapifhir__org.hl7.fhir.core_CVE-2023-28465_5.6.105/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/Scanner.java
```java
>>>  364:   protected void extractFile(ZipInputStream zipIn, String filePath) throws IOException {
```

### Data Flow Step 4: org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/Scanner.java, Line 365, Column 78
File: codeql-dbs/hapifhir__org.hl7.fhir.core_CVE-2023-28465_5.6.105/root/cwe-bench-java/project-sources/hapifhir__org.hl7.fhir.core_CVE-2023-28465_5.6.105/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/Scanner.java
```java
>>>  365:     BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(filePath));
```
