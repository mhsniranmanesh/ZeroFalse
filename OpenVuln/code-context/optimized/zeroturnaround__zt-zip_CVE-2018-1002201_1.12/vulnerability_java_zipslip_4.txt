# Vulnerability: java/zipslip
## Message: Unsanitized archive entry, which may contain '..', is used in a [file system operation](1).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](2).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](3).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](4).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](5).
Unsanitized archive entry, which may contain '..', is used in a [file system operation](6).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: src/main/java/org/zeroturnaround/zip/Zips.java, Line 676, Column 26
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/Zips.java
```java
>>>  676:       String entryName = zipEntry.getName();
```

**Intermediate code within method `process` (lines 677-689):**
```java
     677: 
     678:       if (visitedNames.contains(entryName)) {
     679:         return;
     680:       }
     681:       visitedNames.add(entryName);
     682: 
     683:       File file = new File(destination, entryName);
     684:       if (zipEntry.isDirectory()) {
     685:         FileUtils.forceMkdir(file);
     686:         return;
     687:       }
     688:       else {
     689:         FileUtils.forceMkdir(file.getParentFile());
     690:         file.createNewFile();
```

### Data Flow Step 2: src/main/java/org/zeroturnaround/zip/Zips.java, Line 690, Column 9
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/Zips.java
```java
>>>  690:         file.createNewFile();
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: src/main/java/org/zeroturnaround/zip/Zips.java, Line 676, Column 26
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/Zips.java
```java
>>>  676:       String entryName = zipEntry.getName();
```

**Intermediate code within method `process` (lines 677-694):**
```java
     677: 
     678:       if (visitedNames.contains(entryName)) {
     679:         return;
     680:       }
     681:       visitedNames.add(entryName);
     682: 
     683:       File file = new File(destination, entryName);
     684:       if (zipEntry.isDirectory()) {
     685:         FileUtils.forceMkdir(file);
     686:         return;
     687:       }
     688:       else {
     689:         FileUtils.forceMkdir(file.getParentFile());
     690:         file.createNewFile();
     691:       }
     692: 
     693:       ZipEntryTransformer transformer = (ZipEntryTransformer) entryByPath.remove(entryName);
     694:       if (transformer == null) { // no transformer
     695:         FileUtils.copy(in, file);
```

### Data Flow Step 2: src/main/java/org/zeroturnaround/zip/Zips.java, Line 695, Column 28
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/Zips.java
```java
>>>  695:         FileUtils.copy(in, file);
```

### Data Flow Step 3: src/main/java/org/zeroturnaround/zip/commons/FileUtils.java, Line 53, Column 43
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/commons/FileUtils.java
```java
>>>   53:   public static void copy(InputStream in, File file) throws IOException {
```

### Data Flow Step 4: src/main/java/org/zeroturnaround/zip/commons/FileUtils.java, Line 54, Column 70
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/commons/FileUtils.java
```java
>>>   54:     OutputStream out = new BufferedOutputStream(new FileOutputStream(file));
```

## Code Flow 3

### Thread Flow 1

### Data Flow Step 1: src/main/java/org/zeroturnaround/zip/Zips.java, Line 676, Column 26
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/Zips.java
```java
>>>  676:       String entryName = zipEntry.getName();
```

**Intermediate code within method `process` (lines 677-684):**
```java
     677: 
     678:       if (visitedNames.contains(entryName)) {
     679:         return;
     680:       }
     681:       visitedNames.add(entryName);
     682: 
     683:       File file = new File(destination, entryName);
     684:       if (zipEntry.isDirectory()) {
     685:         FileUtils.forceMkdir(file);
```

### Data Flow Step 2: src/main/java/org/zeroturnaround/zip/Zips.java, Line 685, Column 30
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/Zips.java
```java
>>>  685:         FileUtils.forceMkdir(file);
```

### Data Flow Step 3: src/main/java/org/zeroturnaround/zip/commons/FileUtilsV2_2.java, Line 880, Column 33
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/commons/FileUtilsV2_2.java
```java
>>>  880:   public static void forceMkdir(File directory) throws IOException {
```

### Data Flow Step 4: src/main/java/org/zeroturnaround/zip/commons/FileUtilsV2_2.java, Line 881, Column 9
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/commons/FileUtilsV2_2.java
```java
>>>  881:     if (directory.exists()) {
```

## Code Flow 4

### Thread Flow 1

### Data Flow Step 1: src/main/java/org/zeroturnaround/zip/Zips.java, Line 676, Column 26
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/Zips.java
```java
>>>  676:       String entryName = zipEntry.getName();
```

**Intermediate code within method `process` (lines 677-684):**
```java
     677: 
     678:       if (visitedNames.contains(entryName)) {
     679:         return;
     680:       }
     681:       visitedNames.add(entryName);
     682: 
     683:       File file = new File(destination, entryName);
     684:       if (zipEntry.isDirectory()) {
     685:         FileUtils.forceMkdir(file);
```

### Data Flow Step 2: src/main/java/org/zeroturnaround/zip/Zips.java, Line 685, Column 30
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/Zips.java
```java
>>>  685:         FileUtils.forceMkdir(file);
```

### Data Flow Step 3: src/main/java/org/zeroturnaround/zip/commons/FileUtilsV2_2.java, Line 880, Column 33
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/commons/FileUtilsV2_2.java
```java
>>>  880:   public static void forceMkdir(File directory) throws IOException {
```

**Intermediate code within method `forceMkdir` (lines 881-881):**
```java
     881:     if (directory.exists()) {
     882:       if (!directory.isDirectory()) {
```

### Data Flow Step 4: src/main/java/org/zeroturnaround/zip/commons/FileUtilsV2_2.java, Line 882, Column 12
File: codeql-dbs/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/root/cwe-bench-java/project-sources/zeroturnaround__zt-zip_CVE-2018-1002201_1.12/src/main/java/org/zeroturnaround/zip/commons/FileUtilsV2_2.java
```java
>>>  882:       if (!directory.isDirectory()) {
```
