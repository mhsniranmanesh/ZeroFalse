# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
>>>  473:             result = m_request.getParameter( paramName );
```

**Intermediate code within method `getHttpParameter` (lines 474-475):**
```java
     474:         }
     475: 
     476:         return result;
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
>>>  476:         return result;
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 200, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
>>>  200:                     s = context.getHttpParameter( varName );
```

**Intermediate code within method `getValue` (lines 201-201):**
```java
     201:                     if( s != null ) {
     202:                         return s;
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 202, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
>>>  202:                         return s;
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 81, Column 21
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
>>>   81:             value = engine.getManager( VariableManager.class ).getValue( m_wikiContext, getVar() );
```

**Intermediate code within method `doWikiStartTag` (lines 82-94):**
```java
      82:         } catch( final NoSuchVariableException e ) {
      83:             msg = "No such variable: " + e.getMessage();
      84:         } catch( final IllegalArgumentException e ) {
      85:             msg = "Incorrect variable name: " + e.getMessage();
      86:         }
      87: 
      88:         if( value == null ) {
      89:             value = m_default;
      90:         }
      91: 
      92:         if( value == null ) {
      93:             value = msg;
      94:         }
      95:         out.write( TextUtil.replaceEntities(value) );
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 95, Column 45
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
>>>   95:         out.write( TextUtil.replaceEntities(value) );
```

### Data Flow Step 7: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  214:     public static String replaceEntities( String src ) {
```

### Data Flow Step 8: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  215:         src = replaceString( src, "&", "&amp;" );
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-238):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  239:             return orig;
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  215:         src = replaceString( src, "&", "&amp;" );
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  216:         src = replaceString( src, "<", "&lt;" );
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-238):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  239:             return orig;
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  216:         src = replaceString( src, "<", "&lt;" );
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  217:         src = replaceString( src, ">", "&gt;" );
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-238):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  239:             return orig;
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  217:         src = replaceString( src, ">", "&gt;" );
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  218:         src = replaceString( src, "\"", "&quot;" );
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-238):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  239:             return orig;
```

### Data Flow Step 23: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  218:         src = replaceString( src, "\"", "&quot;" );
```

**Intermediate code within method `replaceEntities` (lines 219-219):**
```java
     219: 
     220:         return src;
```

### Data Flow Step 24: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  220:         return src;
```

### Data Flow Step 25: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 95, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
>>>   95:         out.write( TextUtil.replaceEntities(value) );
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
>>>  473:             result = m_request.getParameter( paramName );
```

**Intermediate code within method `getHttpParameter` (lines 474-475):**
```java
     474:         }
     475: 
     476:         return result;
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
>>>  476:         return result;
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 200, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
>>>  200:                     s = context.getHttpParameter( varName );
```

**Intermediate code within method `getValue` (lines 201-201):**
```java
     201:                     if( s != null ) {
     202:                         return s;
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 202, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
>>>  202:                         return s;
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 81, Column 21
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
>>>   81:             value = engine.getManager( VariableManager.class ).getValue( m_wikiContext, getVar() );
```

**Intermediate code within method `doWikiStartTag` (lines 82-94):**
```java
      82:         } catch( final NoSuchVariableException e ) {
      83:             msg = "No such variable: " + e.getMessage();
      84:         } catch( final IllegalArgumentException e ) {
      85:             msg = "Incorrect variable name: " + e.getMessage();
      86:         }
      87: 
      88:         if( value == null ) {
      89:             value = m_default;
      90:         }
      91: 
      92:         if( value == null ) {
      93:             value = msg;
      94:         }
      95:         out.write( TextUtil.replaceEntities(value) );
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 95, Column 45
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
>>>   95:         out.write( TextUtil.replaceEntities(value) );
```

### Data Flow Step 7: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  214:     public static String replaceEntities( String src ) {
```

### Data Flow Step 8: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  215:         src = replaceString( src, "&", "&amp;" );
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-247):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
     248:             res.append( orig, last, start );
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

**Intermediate code within method `replaceString` (lines 249-254):**
```java
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
     255:         return res.toString();
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  215:         src = replaceString( src, "&", "&amp;" );
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  216:         src = replaceString( src, "<", "&lt;" );
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-247):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
     248:             res.append( orig, last, start );
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

**Intermediate code within method `replaceString` (lines 249-254):**
```java
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
     255:         return res.toString();
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  216:         src = replaceString( src, "<", "&lt;" );
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  217:         src = replaceString( src, ">", "&gt;" );
```

### Data Flow Step 23: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-247):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
     248:             res.append( orig, last, start );
```

### Data Flow Step 24: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

### Data Flow Step 25: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

**Intermediate code within method `replaceString` (lines 249-254):**
```java
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
     255:         return res.toString();
```

### Data Flow Step 26: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 27: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 28: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  217:         src = replaceString( src, ">", "&gt;" );
```

### Data Flow Step 29: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  218:         src = replaceString( src, "\"", "&quot;" );
```

### Data Flow Step 30: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-247):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
     248:             res.append( orig, last, start );
```

### Data Flow Step 31: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

### Data Flow Step 32: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

**Intermediate code within method `replaceString` (lines 249-254):**
```java
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
     255:         return res.toString();
```

### Data Flow Step 33: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 34: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 35: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  218:         src = replaceString( src, "\"", "&quot;" );
```

**Intermediate code within method `replaceEntities` (lines 219-219):**
```java
     219: 
     220:         return src;
```

### Data Flow Step 36: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  220:         return src;
```

### Data Flow Step 37: jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java, Line 95, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/VariableTag.java
```java
>>>   95:         out.write( TextUtil.replaceEntities(value) );
```
