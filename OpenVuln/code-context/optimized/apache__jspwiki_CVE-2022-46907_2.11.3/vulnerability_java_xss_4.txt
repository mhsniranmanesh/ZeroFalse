# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).
Cross-site scripting vulnerability due to a [user-provided value](2).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 245, Column 23
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  245:                 out = cookie.getValue();
```

**Intermediate code within method `doEndTag` (lines 246-259):**
```java
     246:             }
     247:         }
     248: 
     249:         if( out != null )
     250:         {
     251:             if( m_var != null )
     252:             {
     253:                 final int scope = getScope( m_scope );
     254:                 pageContext.setAttribute( m_var, out,  scope );
     255:             }
     256:             else
     257:             {
     258:                 try
     259:                 {
     260:                     pageContext.getOut().print( out );
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 260, Column 49
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  260:                     pageContext.getOut().print( out );
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 320, Column 27
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  320:         final String in = c.getValue();
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 321, Column 65
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  321:         final Map< String, String > values = parseCookieValues( in );
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 330, Column 51
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  330:     private Map<String, String> parseCookieValues(final String s )
```

**Intermediate code within method `parseCookieValues` (lines 331-335):**
```java
     331:     {
     332:         final Map< String, String > rval = new HashMap<>();
     333:         if( s == null ) {
     334:             return rval;
     335:         }
     336:         final String[] nvps = s.split( "&" );
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 336, Column 31
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  336:         final String[] nvps = s.split( "&" );
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 336, Column 31
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  336:         final String[] nvps = s.split( "&" );
```

**Intermediate code within method `parseCookieValues` (lines 337-340):**
```java
     337:         if( nvps.length == 0 ) {
     338:             return rval;
     339:         }
     340:         for (final String value : nvps) {
     341:             final String nvp = decode(value);
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 341, Column 39
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  341:             final String nvp = decode(value);
```

### Data Flow Step 7: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 399, Column 27
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  399:     private String decode(final String envp )
```

**Intermediate code within method `decode` (lines 400-409):**
```java
     400:     {
     401:         final String rval;
     402:         try
     403:         {
     404:             rval = URLDecoder.decode( envp , StandardCharsets.UTF_8.name() );
     405:             return rval;
     406:         }
     407:         catch( final UnsupportedEncodingException e )
     408:         {
     409:             LOG.error( "Failed to decode cookie", e );
     410:             return envp;
```

### Data Flow Step 8: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 410, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  410:             return envp;
```

### Data Flow Step 9: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 341, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  341:             final String nvp = decode(value);
```

### Data Flow Step 10: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 342, Column 33
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  342:             final String[] nv = nvp.split("=");
```

### Data Flow Step 11: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 342, Column 33
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  342:             final String[] nv = nvp.split("=");
```

**Intermediate code within method `parseCookieValues` (lines 343-343):**
```java
     343:             if (nv[0] != null && !nv[0].trim().isEmpty()) {
     344:                 rval.put(nv[0], nv[1]);
```

### Data Flow Step 12: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 344, Column 33
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  344:                 rval.put(nv[0], nv[1]);
```

### Data Flow Step 13: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 344, Column 17
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  344:                 rval.put(nv[0], nv[1]);
```

**Intermediate code within method `parseCookieValues` (lines 345-347):**
```java
     345:             }
     346:         }
     347: 
     348:         return rval;
```

### Data Flow Step 14: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 348, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  348:         return rval;
```

### Data Flow Step 15: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 321, Column 46
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  321:         final Map< String, String > values = parseCookieValues( in );
```

### Data Flow Step 16: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 322, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  322:         return values.get( item );
```

### Data Flow Step 17: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 322, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  322:         return values.get( item );
```

### Data Flow Step 18: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 241, Column 23
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  241:                 out = getItemValue( cookie, m_item );
```

**Intermediate code within method `doEndTag` (lines 242-259):**
```java
     242:             }
     243:             else
     244:             {
     245:                 out = cookie.getValue();
     246:             }
     247:         }
     248: 
     249:         if( out != null )
     250:         {
     251:             if( m_var != null )
     252:             {
     253:                 final int scope = getScope( m_scope );
     254:                 pageContext.setAttribute( m_var, out,  scope );
     255:             }
     256:             else
     257:             {
     258:                 try
     259:                 {
     260:                     pageContext.getOut().print( out );
```

### Data Flow Step 19: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 260, Column 49
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  260:                     pageContext.getOut().print( out );
```

## Code Flow 3

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 320, Column 27
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  320:         final String in = c.getValue();
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 321, Column 65
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  321:         final Map< String, String > values = parseCookieValues( in );
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 330, Column 51
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  330:     private Map<String, String> parseCookieValues(final String s )
```

**Intermediate code within method `parseCookieValues` (lines 331-335):**
```java
     331:     {
     332:         final Map< String, String > rval = new HashMap<>();
     333:         if( s == null ) {
     334:             return rval;
     335:         }
     336:         final String[] nvps = s.split( "&" );
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 336, Column 31
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  336:         final String[] nvps = s.split( "&" );
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 336, Column 31
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  336:         final String[] nvps = s.split( "&" );
```

**Intermediate code within method `parseCookieValues` (lines 337-340):**
```java
     337:         if( nvps.length == 0 ) {
     338:             return rval;
     339:         }
     340:         for (final String value : nvps) {
     341:             final String nvp = decode(value);
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 341, Column 39
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  341:             final String nvp = decode(value);
```

### Data Flow Step 7: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 399, Column 27
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  399:     private String decode(final String envp )
```

**Intermediate code within method `decode` (lines 400-403):**
```java
     400:     {
     401:         final String rval;
     402:         try
     403:         {
     404:             rval = URLDecoder.decode( envp , StandardCharsets.UTF_8.name() );
```

### Data Flow Step 8: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 404, Column 39
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  404:             rval = URLDecoder.decode( envp , StandardCharsets.UTF_8.name() );
```

### Data Flow Step 9: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 404, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  404:             rval = URLDecoder.decode( envp , StandardCharsets.UTF_8.name() );
```

### Data Flow Step 10: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 405, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  405:             return rval;
```

### Data Flow Step 11: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 341, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  341:             final String nvp = decode(value);
```

### Data Flow Step 12: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 342, Column 33
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  342:             final String[] nv = nvp.split("=");
```

### Data Flow Step 13: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 342, Column 33
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  342:             final String[] nv = nvp.split("=");
```

**Intermediate code within method `parseCookieValues` (lines 343-343):**
```java
     343:             if (nv[0] != null && !nv[0].trim().isEmpty()) {
     344:                 rval.put(nv[0], nv[1]);
```

### Data Flow Step 14: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 344, Column 33
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  344:                 rval.put(nv[0], nv[1]);
```

### Data Flow Step 15: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 344, Column 17
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  344:                 rval.put(nv[0], nv[1]);
```

**Intermediate code within method `parseCookieValues` (lines 345-347):**
```java
     345:             }
     346:         }
     347: 
     348:         return rval;
```

### Data Flow Step 16: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 348, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  348:         return rval;
```

### Data Flow Step 17: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 321, Column 46
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  321:         final Map< String, String > values = parseCookieValues( in );
```

### Data Flow Step 18: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 322, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  322:         return values.get( item );
```

### Data Flow Step 19: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 322, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  322:         return values.get( item );
```

### Data Flow Step 20: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 241, Column 23
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  241:                 out = getItemValue( cookie, m_item );
```

**Intermediate code within method `doEndTag` (lines 242-259):**
```java
     242:             }
     243:             else
     244:             {
     245:                 out = cookie.getValue();
     246:             }
     247:         }
     248: 
     249:         if( out != null )
     250:         {
     251:             if( m_var != null )
     252:             {
     253:                 final int scope = getScope( m_scope );
     254:                 pageContext.setAttribute( m_var, out,  scope );
     255:             }
     256:             else
     257:             {
     258:                 try
     259:                 {
     260:                     pageContext.getOut().print( out );
```

### Data Flow Step 21: jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java, Line 260, Column 49
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/CookieTag.java
```java
>>>  260:                     pageContext.getOut().print( out );
```
