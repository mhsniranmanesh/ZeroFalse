# Vulnerability: java/xss
## Message: Cross-site scripting vulnerability due to a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
>>>  473:             result = m_request.getParameter( paramName );
```

**Intermediate code within method `getHttpParameter` (lines 474-475):**
```java
     474:         }
     475: 
     476:         return result;
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
>>>  476:         return result;
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 200, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
>>>  200:                     s = context.getHttpParameter( varName );
```

**Intermediate code within method `getValue` (lines 201-201):**
```java
     201:                     if( s != null ) {
     202:                         return s;
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 202, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
>>>  202:                         return s;
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java, Line 63, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java
```java
>>>   63:             blogname = engine.getManager( VariableManager.class ).getValue(context, VAR_BLOGNAME);
```

**Intermediate code within method `getSiteName` (lines 64-70):**
```java
      64:         } catch( final NoSuchVariableException e ) {
      65:         }
      66: 
      67:         if (blogname == null) {
      68:             blogname = engine.getApplicationName() + ": " + context.getPage().getName();
      69:         }
      70: 
      71:         return blogname;
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java, Line 71, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java
```java
>>>   71:         return blogname;
```

### Data Flow Step 7: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 49, Column 31
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
>>>   49:             String siteName = Feed.getSiteName(m_wikiContext);
```

### Data Flow Step 8: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 50, Column 50
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
>>>   50:             siteName = TextUtil.replaceEntities( siteName );
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  214:     public static String replaceEntities( String src ) {
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  215:         src = replaceString( src, "&", "&amp;" );
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-238):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  239:             return orig;
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  215:         src = replaceString( src, "&", "&amp;" );
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  216:         src = replaceString( src, "<", "&lt;" );
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-238):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  239:             return orig;
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  216:         src = replaceString( src, "<", "&lt;" );
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  217:         src = replaceString( src, ">", "&gt;" );
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-238):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  239:             return orig;
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  217:         src = replaceString( src, ">", "&gt;" );
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  218:         src = replaceString( src, "\"", "&quot;" );
```

### Data Flow Step 23: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-238):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
```

### Data Flow Step 24: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 239, Column 20
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  239:             return orig;
```

### Data Flow Step 25: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  218:         src = replaceString( src, "\"", "&quot;" );
```

**Intermediate code within method `replaceEntities` (lines 219-219):**
```java
     219: 
     220:         return src;
```

### Data Flow Step 26: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  220:         return src;
```

### Data Flow Step 27: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 50, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
>>>   50:             siteName = TextUtil.replaceEntities( siteName );
```

**Intermediate code within method `doWikiStartTag` (lines 51-64):**
```java
      51: 
      52:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for the entire site.\" href=\""+rssURL+"\" />\n");
      53:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for page "+siteName+".\" href=\""+rssFeedURL+"\" />\n");
      54: 
      55:             // TODO: Enable this
      56:             /*
      57:             pageContext.getOut().print("<link rel=\"service.post\" type=\"application/atom+xml\" title=\""+
      58:                                        siteName+"\" href=\""+atomPostURL+"\" />\n");
      59:             */
      60:             // FIXME: This does not work always, as plugins are not initialized until the first fetch
      61:             if( "true".equals( page.getAttribute( WeblogPlugin.ATTR_ISWEBLOG ) ) ) {
      62:                 final String blogFeedURL = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(),"rss.jsp","page="+encodedName );
      63:                 final String atomFeedURL = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(),"rss.jsp","page="+encodedName+"&amp;type=atom" );
      64: 
      65:                 pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS feed for weblog "+
```

### Data Flow Step 28: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 65, Column 44
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
>>>   65:                 pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS feed for weblog "+
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 473, Column 22
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
>>>  473:             result = m_request.getParameter( paramName );
```

**Intermediate code within method `getHttpParameter` (lines 474-475):**
```java
     474:         }
     475: 
     476:         return result;
```

### Data Flow Step 2: jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java, Line 476, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/WikiContext.java
```java
>>>  476:         return result;
```

### Data Flow Step 3: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 200, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
>>>  200:                     s = context.getHttpParameter( varName );
```

**Intermediate code within method `getValue` (lines 201-201):**
```java
     201:                     if( s != null ) {
     202:                         return s;
```

### Data Flow Step 4: jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java, Line 202, Column 32
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/variables/DefaultVariableManager.java
```java
>>>  202:                         return s;
```

### Data Flow Step 5: jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java, Line 63, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java
```java
>>>   63:             blogname = engine.getManager( VariableManager.class ).getValue(context, VAR_BLOGNAME);
```

**Intermediate code within method `getSiteName` (lines 64-70):**
```java
      64:         } catch( final NoSuchVariableException e ) {
      65:         }
      66: 
      67:         if (blogname == null) {
      68:             blogname = engine.getApplicationName() + ": " + context.getPage().getName();
      69:         }
      70: 
      71:         return blogname;
```

### Data Flow Step 6: jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java, Line 71, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/rss/Feed.java
```java
>>>   71:         return blogname;
```

### Data Flow Step 7: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 49, Column 31
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
>>>   49:             String siteName = Feed.getSiteName(m_wikiContext);
```

### Data Flow Step 8: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 50, Column 50
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
>>>   50:             siteName = TextUtil.replaceEntities( siteName );
```

### Data Flow Step 9: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 214, Column 43
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  214:     public static String replaceEntities( String src ) {
```

### Data Flow Step 10: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  215:         src = replaceString( src, "&", "&amp;" );
```

### Data Flow Step 11: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-247):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
     248:             res.append( orig, last, start );
```

### Data Flow Step 12: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

### Data Flow Step 13: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

**Intermediate code within method `replaceString` (lines 249-254):**
```java
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
     255:         return res.toString();
```

### Data Flow Step 14: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 15: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 16: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 215, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  215:         src = replaceString( src, "&", "&amp;" );
```

### Data Flow Step 17: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  216:         src = replaceString( src, "<", "&lt;" );
```

### Data Flow Step 18: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-247):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
     248:             res.append( orig, last, start );
```

### Data Flow Step 19: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

### Data Flow Step 20: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

**Intermediate code within method `replaceString` (lines 249-254):**
```java
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
     255:         return res.toString();
```

### Data Flow Step 21: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 22: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 23: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 216, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  216:         src = replaceString( src, "<", "&lt;" );
```

### Data Flow Step 24: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  217:         src = replaceString( src, ">", "&gt;" );
```

### Data Flow Step 25: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-247):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
     248:             res.append( orig, last, start );
```

### Data Flow Step 26: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

### Data Flow Step 27: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

**Intermediate code within method `replaceString` (lines 249-254):**
```java
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
     255:         return res.toString();
```

### Data Flow Step 28: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 29: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 30: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 217, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  217:         src = replaceString( src, ">", "&gt;" );
```

### Data Flow Step 31: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 30
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  218:         src = replaceString( src, "\"", "&quot;" );
```

### Data Flow Step 32: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 231, Column 41
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  231:     public static String replaceString( final String orig, final String src, final String dest ) {
```

**Intermediate code within method `replaceString` (lines 232-247):**
```java
     232:         if ( orig == null ) {
     233:             return null;
     234:         }
     235:         if ( src == null || dest == null ) {
     236:             throw new NullPointerException();
     237:         }
     238:         if ( src.isEmpty() ) {
     239:             return orig;
     240:         }
     241: 
     242:         final StringBuilder res = new StringBuilder( orig.length() + 20 ); // Pure guesswork
     243:         int start;
     244:         int end = 0;
     245:         int last = 0;
     246: 
     247:         while ( ( start = orig.indexOf( src,end ) ) != -1 ) {
     248:             res.append( orig, last, start );
```

### Data Flow Step 33: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 25
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

### Data Flow Step 34: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 248, Column 13
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  248:             res.append( orig, last, start );
```

**Intermediate code within method `replaceString` (lines 249-254):**
```java
     249:             res.append( dest );
     250:             end  = start + src.length();
     251:             last = start + src.length();
     252:         }
     253:         res.append( orig.substring( end ) );
     254: 
     255:         return res.toString();
```

### Data Flow Step 35: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 36: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 255, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  255:         return res.toString();
```

### Data Flow Step 37: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 218, Column 15
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  218:         src = replaceString( src, "\"", "&quot;" );
```

**Intermediate code within method `replaceEntities` (lines 219-219):**
```java
     219: 
     220:         return src;
```

### Data Flow Step 38: jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java, Line 220, Column 16
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-util/src/main/java/org/apache/wiki/util/TextUtil.java
```java
>>>  220:         return src;
```

### Data Flow Step 39: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 50, Column 24
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
>>>   50:             siteName = TextUtil.replaceEntities( siteName );
```

**Intermediate code within method `doWikiStartTag` (lines 51-64):**
```java
      51: 
      52:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for the entire site.\" href=\""+rssURL+"\" />\n");
      53:             pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS wiki feed for page "+siteName+".\" href=\""+rssFeedURL+"\" />\n");
      54: 
      55:             // TODO: Enable this
      56:             /*
      57:             pageContext.getOut().print("<link rel=\"service.post\" type=\"application/atom+xml\" title=\""+
      58:                                        siteName+"\" href=\""+atomPostURL+"\" />\n");
      59:             */
      60:             // FIXME: This does not work always, as plugins are not initialized until the first fetch
      61:             if( "true".equals( page.getAttribute( WeblogPlugin.ATTR_ISWEBLOG ) ) ) {
      62:                 final String blogFeedURL = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(),"rss.jsp","page="+encodedName );
      63:                 final String atomFeedURL = engine.getURL( ContextEnum.PAGE_NONE.getRequestContext(),"rss.jsp","page="+encodedName+"&amp;type=atom" );
      64: 
      65:                 pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS feed for weblog "+
```

### Data Flow Step 40: jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java, Line 65, Column 44
File: codeql-dbs/apache__jspwiki_CVE-2022-46907_2.11.3/root/cwe-bench-java/project-sources/apache__jspwiki_CVE-2022-46907_2.11.3/jspwiki-main/src/main/java/org/apache/wiki/tags/FeedDiscoveryTag.java
```java
>>>   65:                 pageContext.getOut().print("<link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS feed for weblog "+
```
