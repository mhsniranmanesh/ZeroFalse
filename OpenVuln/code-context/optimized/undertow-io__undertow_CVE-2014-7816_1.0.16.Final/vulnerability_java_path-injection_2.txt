# Vulnerability: java/path-injection
## Message: This path depends on a [user-provided value](1).
This path depends on a [user-provided value](2).
This path depends on a [user-provided value](3).
This path depends on a [user-provided value](4).
This path depends on a [user-provided value](5).
This path depends on a [user-provided value](6).
This path depends on a [user-provided value](7).
This path depends on a [user-provided value](8).
This path depends on a [user-provided value](9).
This path depends on a [user-provided value](10).
This path depends on a [user-provided value](11).
This path depends on a [user-provided value](12).
This path depends on a [user-provided value](13).
This path depends on a [user-provided value](14).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java, Line 302, Column 24
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java
```java
>>>  302:             pathInfo = request.getPathInfo();
```

**Intermediate code within method `getPath` (lines 303-313):**
```java
     303:             servletPath = request.getServletPath();
     304:         }
     305:         String result = pathInfo;
     306:         if (result == null) {
     307:             result = servletPath;
     308:         } else if(resolveAgainstContextRoot) {
     309:             result = servletPath + pathInfo;
     310:         }
     311:         if ((result == null) || (result.equals(""))) {
     312:             result = "/";
     313:         }
     314:         return result;
```

### Data Flow Step 2: servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java, Line 314, Column 16
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java
```java
>>>  314:         return result;
```

### Data Flow Step 3: servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java, Line 129, Column 29
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java
```java
>>>  129:         final String path = getPath(req);
```

**Intermediate code within method `doGet` (lines 130-133):**
```java
     130:         if (!isAllowed(path)) {
     131:             resp.sendError(404);
     132:             return;
     133:         }
     134:         final Resource resource = resourceManager.getResource(path);
```

### Data Flow Step 4: servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java, Line 134, Column 63
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java
```java
>>>  134:         final Resource resource = resourceManager.getResource(path);
```

### Data Flow Step 5: core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java, Line 80, Column 33
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java
```java
>>>   80:     public Resource getResource(final String p) {
```

**Intermediate code within method `getResource` (lines 81-89):**
```java
      81:         String path = null;
      82:         //base always ends with a /
      83:         if (p.startsWith("/")) {
      84:             path = p.substring(1);
      85:         } else {
      86:             path = p;
      87:         }
      88:         try {
      89:             File file = new File(base, path);
      90:             if (file.exists()) {
```

### Data Flow Step 6: core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java, Line 90, Column 17
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java
```java
>>>   90:             if (file.exists()) {
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java, Line 303, Column 27
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java
```java
>>>  303:             servletPath = request.getServletPath();
```

**Intermediate code within method `getPath` (lines 304-313):**
```java
     304:         }
     305:         String result = pathInfo;
     306:         if (result == null) {
     307:             result = servletPath;
     308:         } else if(resolveAgainstContextRoot) {
     309:             result = servletPath + pathInfo;
     310:         }
     311:         if ((result == null) || (result.equals(""))) {
     312:             result = "/";
     313:         }
     314:         return result;
```

### Data Flow Step 2: servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java, Line 314, Column 16
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java
```java
>>>  314:         return result;
```

### Data Flow Step 3: servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java, Line 129, Column 29
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java
```java
>>>  129:         final String path = getPath(req);
```

**Intermediate code within method `doGet` (lines 130-133):**
```java
     130:         if (!isAllowed(path)) {
     131:             resp.sendError(404);
     132:             return;
     133:         }
     134:         final Resource resource = resourceManager.getResource(path);
```

### Data Flow Step 4: servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java, Line 134, Column 63
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/DefaultServlet.java
```java
>>>  134:         final Resource resource = resourceManager.getResource(path);
```

### Data Flow Step 5: core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java, Line 80, Column 33
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java
```java
>>>   80:     public Resource getResource(final String p) {
```

**Intermediate code within method `getResource` (lines 81-89):**
```java
      81:         String path = null;
      82:         //base always ends with a /
      83:         if (p.startsWith("/")) {
      84:             path = p.substring(1);
      85:         } else {
      86:             path = p;
      87:         }
      88:         try {
      89:             File file = new File(base, path);
      90:             if (file.exists()) {
```

### Data Flow Step 6: core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java, Line 90, Column 17
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java
```java
>>>   90:             if (file.exists()) {
```

## Code Flow 3

### Thread Flow 1

### Data Flow Step 1: servlet/src/main/java/io/undertow/servlet/handlers/ServletInitialHandler.java, Line 198, Column 69
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletInitialHandler.java
```java
>>>  198:         final ServletPathMatch info = paths.getServletHandlerByPath(request.getServletPath());
```

### Data Flow Step 2: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 74, Column 53
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   74:     public ServletPathMatch getServletHandlerByPath(final String path) {
```

### Data Flow Step 3: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 75, Column 68
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   75:         ServletPathMatch match = getData().getServletHandlerByPath(path);
```

### Data Flow Step 4: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 59, Column 53
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   59:     public ServletPathMatch getServletHandlerByPath(final String path) {
```

**Intermediate code within method `getServletHandlerByPath` (lines 60-65):**
```java
      60:         ServletPathMatch exact = exactPathMatches.get(path);
      61:         if (exact != null) {
      62:             return exact;
      63:         }
      64:         PathMatch match = prefixMatches.get(path);
      65:         if (match != null) {
      66:             return handleMatch(path, match, path.lastIndexOf('.'));
```

### Data Flow Step 5: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 66, Column 32
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   66:             return handleMatch(path, match, path.lastIndexOf('.'));
```

### Data Flow Step 6: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 88, Column 42
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   88:     private ServletPathMatch handleMatch(final String path, final PathMatch match, final int extensionPos) {
```

**Intermediate code within method `handleMatch` (lines 89-89):**
```java
      89:         if (match.extensionMatches.isEmpty()) {
      90:             return new ServletPathMatch(match.defaultHandler, path, match.requireWelcomeFileMatch);
```

### Data Flow Step 7: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 90, Column 63
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   90:             return new ServletPathMatch(match.defaultHandler, path, match.requireWelcomeFileMatch);
```

### Data Flow Step 8: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 33, Column 56
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   33:     public ServletPathMatch(final ServletChain target, final String uri, boolean requiredWelcomeFileMatch) {
```

### Data Flow Step 9: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 40, Column 28
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   40:             this.matched = uri;
```

### Data Flow Step 10: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 40, Column 13
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   40:             this.matched = uri;
```

### Data Flow Step 11: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 33, Column 12
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   33:     public ServletPathMatch(final ServletChain target, final String uri, boolean requiredWelcomeFileMatch) {
```

### Data Flow Step 12: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 90, Column 20
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   90:             return new ServletPathMatch(match.defaultHandler, path, match.requireWelcomeFileMatch);
```

### Data Flow Step 13: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 66, Column 20
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   66:             return handleMatch(path, match, path.lastIndexOf('.'));
```

### Data Flow Step 14: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 75, Column 34
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   75:         ServletPathMatch match = getData().getServletHandlerByPath(path);
```

**Intermediate code within method `getServletHandlerByPath` (lines 76-80):**
```java
      76:         if (!match.isRequiredWelcomeFileMatch()) {
      77:             return match;
      78:         }
      79:         try {
      80: 
      81:             String remaining = match.getRemaining() == null ? match.getMatched() : match.getRemaining();
```

### Data Flow Step 15: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 81, Column 63
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   81:             String remaining = match.getRemaining() == null ? match.getMatched() : match.getRemaining();
```

### Data Flow Step 16: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 61, Column 19
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   61:     public String getMatched() {
```

### Data Flow Step 17: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 62, Column 16
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   62:         return matched;
```

### Data Flow Step 18: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 62, Column 16
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   62:         return matched;
```

### Data Flow Step 19: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 81, Column 63
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   81:             String remaining = match.getRemaining() == null ? match.getMatched() : match.getRemaining();
```

### Data Flow Step 20: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 82, Column 61
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   82:             Resource resource = resourceManager.getResource(remaining);
```

### Data Flow Step 21: core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java, Line 80, Column 33
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java
```java
>>>   80:     public Resource getResource(final String p) {
```

**Intermediate code within method `getResource` (lines 81-89):**
```java
      81:         String path = null;
      82:         //base always ends with a /
      83:         if (p.startsWith("/")) {
      84:             path = p.substring(1);
      85:         } else {
      86:             path = p;
      87:         }
      88:         try {
      89:             File file = new File(base, path);
      90:             if (file.exists()) {
```

### Data Flow Step 22: core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java, Line 90, Column 17
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java
```java
>>>   90:             if (file.exists()) {
```

## Code Flow 4

### Thread Flow 1

### Data Flow Step 1: servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java, Line 154, Column 39
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java
```java
>>>  154:             final String requestURI = ((HttpServletRequest) servletRequest).getRequestURI();
```

**Intermediate code within method `dispatch` (lines 155-158):**
```java
     155:             DeploymentManager context = container.getDeploymentByPath(requestURI);
     156:             if (context == null) {
     157:                 throw UndertowServletMessages.MESSAGES.couldNotFindContextToDispatchTo(requestImpl.getOriginalContextPath());
     158:             }
     159:             String toDispatch = requestURI.substring(context.getDeployment().getServletContext().getContextPath().length());
```

### Data Flow Step 2: servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java, Line 159, Column 33
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java
```java
>>>  159:             String toDispatch = requestURI.substring(context.getDeployment().getServletContext().getContextPath().length());
```

### Data Flow Step 3: servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java, Line 159, Column 33
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java
```java
>>>  159:             String toDispatch = requestURI.substring(context.getDeployment().getServletContext().getContextPath().length());
```

**Intermediate code within method `dispatch` (lines 160-163):**
```java
     160:             String qs = ((HttpServletRequest) servletRequest).getQueryString();
     161:             if (qs != null && !qs.isEmpty()) {
     162:                 toDispatch = toDispatch + "?" + qs;
     163:             }
     164:             dispatch(context.getDeployment().getServletContext(), toDispatch);
```

### Data Flow Step 4: servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java, Line 164, Column 67
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java
```java
>>>  164:             dispatch(context.getDeployment().getServletContext(), toDispatch);
```

### Data Flow Step 5: servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java, Line 203, Column 56
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java
```java
>>>  203:     public void dispatch(final ServletContext context, final String path) {
```

**Intermediate code within method `dispatch` (lines 204-254):**
```java
     204: 
     205:         if (dispatched) {
     206:             throw UndertowServletMessages.MESSAGES.asyncRequestAlreadyDispatched();
     207:         }
     208: 
     209:         HttpServletRequestImpl requestImpl = servletRequestContext.getOriginalRequest();
     210:         HttpServletResponseImpl responseImpl = servletRequestContext.getOriginalResponse();
     211:         final HttpServerExchange exchange = requestImpl.getExchange();
     212: 
     213:         exchange.getAttachment(ServletRequestContext.ATTACHMENT_KEY).setDispatcherType(DispatcherType.ASYNC);
     214: 
     215:         requestImpl.setAttribute(ASYNC_REQUEST_URI, requestImpl.getOriginalRequestURI());
     216:         requestImpl.setAttribute(ASYNC_CONTEXT_PATH, requestImpl.getOriginalContextPath());
     217:         requestImpl.setAttribute(ASYNC_SERVLET_PATH, requestImpl.getOriginalServletPath());
     218:         requestImpl.setAttribute(ASYNC_QUERY_STRING, requestImpl.getOriginalQueryString());
     219: 
     220:         String newQueryString = "";
     221:         int qsPos = path.indexOf("?");
     222:         String newServletPath = path;
     223:         if (qsPos != -1) {
     224:             newQueryString = newServletPath.substring(qsPos + 1);
     225:             newServletPath = newServletPath.substring(0, qsPos);
     226:         }
     227:         String newRequestUri = context.getContextPath() + newServletPath;
     228: 
     229:         //todo: a more efficient impl
     230:         Map<String, Deque<String>> newQueryParameters = new HashMap<String, Deque<String>>();
     231:         for (String part : newQueryString.split("&")) {
     232:             String name = part;
     233:             String value = "";
     234:             int equals = part.indexOf('=');
     235:             if (equals != -1) {
     236:                 name = part.substring(0, equals);
     237:                 value = part.substring(equals + 1);
     238:             }
     239:             Deque<String> queue = newQueryParameters.get(name);
     240:             if (queue == null) {
     241:                 newQueryParameters.put(name, queue = new ArrayDeque<String>(1));
     242:             }
     243:             queue.add(value);
     244:         }
     245:         requestImpl.setQueryParameters(newQueryParameters);
     246: 
     247:         requestImpl.getExchange().setRelativePath(newServletPath);
     248:         requestImpl.getExchange().setQueryString(newQueryString);
     249:         requestImpl.getExchange().setRequestPath(newRequestUri);
     250:         requestImpl.getExchange().setRequestURI(newRequestUri);
     251:         requestImpl.setServletContext((ServletContextImpl) context);
     252:         responseImpl.setServletContext((ServletContextImpl) context);
     253: 
     254:         Deployment deployment = requestImpl.getServletContext().getDeployment();
     255:         ServletPathMatch info = deployment.getServletPaths().getServletHandlerByPath(newServletPath);
```

### Data Flow Step 6: servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java, Line 255, Column 86
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/spec/AsyncContextImpl.java
```java
>>>  255:         ServletPathMatch info = deployment.getServletPaths().getServletHandlerByPath(newServletPath);
```

### Data Flow Step 7: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 74, Column 53
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   74:     public ServletPathMatch getServletHandlerByPath(final String path) {
```

### Data Flow Step 8: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 75, Column 68
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   75:         ServletPathMatch match = getData().getServletHandlerByPath(path);
```

### Data Flow Step 9: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 59, Column 53
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   59:     public ServletPathMatch getServletHandlerByPath(final String path) {
```

**Intermediate code within method `getServletHandlerByPath` (lines 60-65):**
```java
      60:         ServletPathMatch exact = exactPathMatches.get(path);
      61:         if (exact != null) {
      62:             return exact;
      63:         }
      64:         PathMatch match = prefixMatches.get(path);
      65:         if (match != null) {
      66:             return handleMatch(path, match, path.lastIndexOf('.'));
```

### Data Flow Step 10: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 66, Column 32
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   66:             return handleMatch(path, match, path.lastIndexOf('.'));
```

### Data Flow Step 11: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 88, Column 42
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   88:     private ServletPathMatch handleMatch(final String path, final PathMatch match, final int extensionPos) {
```

**Intermediate code within method `handleMatch` (lines 89-89):**
```java
      89:         if (match.extensionMatches.isEmpty()) {
      90:             return new ServletPathMatch(match.defaultHandler, path, match.requireWelcomeFileMatch);
```

### Data Flow Step 12: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 90, Column 63
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   90:             return new ServletPathMatch(match.defaultHandler, path, match.requireWelcomeFileMatch);
```

### Data Flow Step 13: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 33, Column 56
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   33:     public ServletPathMatch(final ServletChain target, final String uri, boolean requiredWelcomeFileMatch) {
```

### Data Flow Step 14: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 40, Column 28
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   40:             this.matched = uri;
```

### Data Flow Step 15: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 40, Column 13
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   40:             this.matched = uri;
```

### Data Flow Step 16: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 33, Column 12
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   33:     public ServletPathMatch(final ServletChain target, final String uri, boolean requiredWelcomeFileMatch) {
```

### Data Flow Step 17: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 90, Column 20
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   90:             return new ServletPathMatch(match.defaultHandler, path, match.requireWelcomeFileMatch);
```

### Data Flow Step 18: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java, Line 66, Column 20
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatchesData.java
```java
>>>   66:             return handleMatch(path, match, path.lastIndexOf('.'));
```

### Data Flow Step 19: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 75, Column 34
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   75:         ServletPathMatch match = getData().getServletHandlerByPath(path);
```

**Intermediate code within method `getServletHandlerByPath` (lines 76-80):**
```java
      76:         if (!match.isRequiredWelcomeFileMatch()) {
      77:             return match;
      78:         }
      79:         try {
      80: 
      81:             String remaining = match.getRemaining() == null ? match.getMatched() : match.getRemaining();
```

### Data Flow Step 20: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 81, Column 63
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   81:             String remaining = match.getRemaining() == null ? match.getMatched() : match.getRemaining();
```

### Data Flow Step 21: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 61, Column 19
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   61:     public String getMatched() {
```

### Data Flow Step 22: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 62, Column 16
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   62:         return matched;
```

### Data Flow Step 23: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java, Line 62, Column 16
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatch.java
```java
>>>   62:         return matched;
```

### Data Flow Step 24: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 81, Column 63
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   81:             String remaining = match.getRemaining() == null ? match.getMatched() : match.getRemaining();
```

### Data Flow Step 25: servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java, Line 82, Column 61
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/servlet/src/main/java/io/undertow/servlet/handlers/ServletPathMatches.java
```java
>>>   82:             Resource resource = resourceManager.getResource(remaining);
```

### Data Flow Step 26: core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java, Line 80, Column 33
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java
```java
>>>   80:     public Resource getResource(final String p) {
```

**Intermediate code within method `getResource` (lines 81-89):**
```java
      81:         String path = null;
      82:         //base always ends with a /
      83:         if (p.startsWith("/")) {
      84:             path = p.substring(1);
      85:         } else {
      86:             path = p;
      87:         }
      88:         try {
      89:             File file = new File(base, path);
      90:             if (file.exists()) {
```

### Data Flow Step 27: core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java, Line 90, Column 17
File: codeql-dbs/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/root/cwe-bench-java/project-sources/undertow-io__undertow_CVE-2014-7816_1.0.16.Final/core/src/main/java/io/undertow/server/handlers/resource/FileResourceManager.java
```java
>>>   90:             if (file.exists()) {
```
