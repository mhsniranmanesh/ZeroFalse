# Vulnerability: java/path-injection
## Message: This path depends on a [user-provided value](1).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 123, Column 67
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  123:                     try (InputStream in = new BufferedInputStream(conn.getInputStream());
```

### Data Flow Step 2: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 124, Column 71
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  124:                             JsonReader jsonReader = Json.createReader(in)) {
```

### Data Flow Step 3: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 124, Column 53
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  124:                             JsonReader jsonReader = Json.createReader(in)) {
```

### Data Flow Step 4: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 125, Column 49
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  125:                         final JsonArray array = jsonReader.readArray();
```

### Data Flow Step 5: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 125, Column 49
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  125:                         final JsonArray array = jsonReader.readArray();
```

**Intermediate code within method `submitPackage` (lines 126-128):**
```java
     126: 
     127:                         if (array != null) {
     128:                             for (int i = 0; i < array.size(); i++) {
     129:                                 final JsonObject object = array.getJsonObject(i);
```

### Data Flow Step 6: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 129, Column 59
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  129:                                 final JsonObject object = array.getJsonObject(i);
```

### Data Flow Step 7: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 129, Column 59
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  129:                                 final JsonObject object = array.getJsonObject(i);
```

**Intermediate code within method `submitPackage` (lines 130-144):**
```java
     130:                                 final Advisory advisory = new Advisory();
     131:                                 advisory.setId(object.getInt("id"));
     132:                                 advisory.setUpdatedAt(object.getString("updated_at", null));
     133:                                 advisory.setCreatedAt(object.getString("created_at", null));
     134:                                 advisory.setPublishDate(object.getString("publish_date", null));
     135:                                 advisory.setOverview(object.getString("overview"));
     136:                                 advisory.setRecommendation(object.getString("recommendation", null));
     137:                                 advisory.setCvssVector(object.getString("cvss_vector", null));
     138: 
     139:                                 if (object.get("cvss_score").getValueType() != ValueType.NULL) {
     140:                                     advisory.setCvssScore(Float.parseFloat(object.getJsonNumber("cvss_score").toString()));
     141:                                 } else {
     142:                                     advisory.setCvssScore(-1);
     143:                                 }
     144: 
     145:                                 advisory.setModule(object.getString("module", null));
```

### Data Flow Step 8: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 145, Column 52
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  145:                                 advisory.setModule(object.getString("module", null));
```

### Data Flow Step 9: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 145, Column 52
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  145:                                 advisory.setModule(object.getString("module", null));
```

### Data Flow Step 10: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 270, Column 27
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  270:     public void setModule(String module) {
```

### Data Flow Step 11: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 271, Column 23
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  271:         this.module = module;
```

### Data Flow Step 12: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 271, Column 9
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  271:         this.module = module;
```

### Data Flow Step 13: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 270, Column 17
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  270:     public void setModule(String module) {
```

### Data Flow Step 14: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 145, Column 33
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  145:                                 advisory.setModule(object.getString("module", null));
```

**Intermediate code within method `submitPackage` (lines 146-158):**
```java
     146:                                 advisory.setVersion(object.getString("version", null));
     147:                                 advisory.setVulnerableVersions(object.getString("vulnerable_versions", null));
     148:                                 advisory.setPatchedVersions(object.getString("patched_versions", null));
     149:                                 advisory.setTitle(object.getString("title", null));
     150:                                 advisory.setAdvisory(object.getString("advisory", null));
     151: 
     152:                                 final JsonArray jsonPath = object.getJsonArray("path");
     153:                                 final List<String> stringPath = new ArrayList<>();
     154:                                 for (int j = 0; j < jsonPath.size(); j++) {
     155:                                     stringPath.add(jsonPath.getString(j));
     156:                                 }
     157:                                 advisory.setPath(stringPath.toArray(new String[stringPath.size()]));
     158: 
     159:                                 result.add(advisory);
```

### Data Flow Step 15: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 159, Column 44
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  159:                                 result.add(advisory);
```

### Data Flow Step 16: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 159, Column 33
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  159:                                 result.add(advisory);
```

**Intermediate code within method `submitPackage` (lines 160-173):**
```java
     160:                             }
     161:                         }
     162:                     }
     163:                     break;
     164: 
     165:                 case 400:
     166:                     LOGGER.debug("Invalid payload submitted to Node Security Platform. Received response code: {} {}",
     167:                             conn.getResponseCode(), conn.getResponseMessage());
     168:                     throw new AnalysisException("Could not perform NSP analysis. Invalid payload submitted to Node Security Platform.");
     169:                 default:
     170:                     LOGGER.debug("Could not connect to Node Security Platform. Received response code: {} {}",
     171:                             conn.getResponseCode(), conn.getResponseMessage());
     172:                     throw new IOException("Could not connect to Node Security Platform");
     173:             }
     174:             return result;
```

### Data Flow Step 17: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 174, Column 20
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  174:             return result;
```

### Data Flow Step 18: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 178, Column 47
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  178:             final List<Advisory> advisories = searcher.submitPackage(nspPayload);
```

**Intermediate code within method `analyzeDependency` (lines 179-179):**
```java
     179: 
     180:             for (Advisory advisory : advisories) {
```

### Data Flow Step 19: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 180, Column 38
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  180:             for (Advisory advisory : advisories) {
```

**Intermediate code within method `analyzeDependency` (lines 181-184):**
```java
     181:                 /*
     182:                  * Create a new vulnerability out of the advisory returned by nsp.
     183:                  */
     184:                 final Vulnerability vuln = new Vulnerability();
     185:                 vuln.setCvssScore(advisory.getCvssScore());
```

### Data Flow Step 20: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 185, Column 35
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  185:                 vuln.setCvssScore(advisory.getCvssScore());
```

**Intermediate code within method `analyzeDependency` (lines 186-207):**
```java
     186:                 vuln.setDescription(advisory.getOverview());
     187:                 vuln.setName(String.valueOf(advisory.getId()));
     188:                 vuln.setSource(Vulnerability.Source.NSP);
     189:                 vuln.addReference(
     190:                         "NSP",
     191:                         "Advisory " + advisory.getId() + ": " + advisory.getTitle(),
     192:                         advisory.getAdvisory()
     193:                 );
     194: 
     195:                 /*
     196:                  * Create a single vulnerable software object - these do not use CPEs unlike the NVD.
     197:                  */
     198:                 final VulnerableSoftware vs = new VulnerableSoftware();
     199:                 //TODO consider changing this to available versions on the dependency
     200:                 //  - the update is a part of the version, not versions to update to
     201:                 //vs.setUpdate(advisory.getPatchedVersions());
     202: 
     203:                 vs.setName(advisory.getModule() + ":" + advisory.getVulnerableVersions());
     204:                 vuln.setVulnerableSoftware(new HashSet<>(Arrays.asList(vs)));
     205: 
     206:                 final Dependency existing = findDependency(engine, advisory.getModule(), advisory.getVersion());
     207:                 if (existing == null) {
     208:                     final Dependency nodeModule = createDependency(dependency, advisory.getModule(), advisory.getVersion(), "transitive");
```

### Data Flow Step 21: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 208, Column 80
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  208:                     final Dependency nodeModule = createDependency(dependency, advisory.getModule(), advisory.getVersion(), "transitive");
```

### Data Flow Step 22: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 261, Column 19
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  261:     public String getModule() {
```

### Data Flow Step 23: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 262, Column 16
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  262:         return module;
```

### Data Flow Step 24: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 262, Column 16
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  262:         return module;
```

### Data Flow Step 25: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 208, Column 80
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  208:                     final Dependency nodeModule = createDependency(dependency, advisory.getModule(), advisory.getVersion(), "transitive");
```

### Data Flow Step 26: core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java, Line 115, Column 66
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java
```java
>>>  115:     protected Dependency createDependency(Dependency dependency, String name, String version, String scope) {
```

### Data Flow Step 27: core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java, Line 116, Column 63
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java
```java
>>>  116:         final Dependency nodeModule = new Dependency(new File(dependency.getActualFile() + "?" + name), true);
```

### Data Flow Step 28: core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java, Line 116, Column 54
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java
```java
>>>  116:         final Dependency nodeModule = new Dependency(new File(dependency.getActualFile() + "?" + name), true);
```

### Data Flow Step 29: core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java, Line 185, Column 23
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java
```java
>>>  185:     public Dependency(File file, boolean isVirtual) {
```

### Data Flow Step 30: core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java, Line 192, Column 25
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java
```java
>>>  192:         determineHashes(file);
```

### Data Flow Step 31: core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java, Line 572, Column 34
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java
```java
>>>  572:     private void determineHashes(File file) {
```

**Intermediate code within method `determineHashes` (lines 573-578):**
```java
     573:         String md5 = null;
     574:         String sha1 = null;
     575:         if (isVirtual) {
     576:             return;
     577:         }
     578:         try {
     579:             md5 = Checksum.getMD5Checksum(file);
```

### Data Flow Step 32: core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java, Line 579, Column 43
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java
```java
>>>  579:             md5 = Checksum.getMD5Checksum(file);
```

### Data Flow Step 33: utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java, Line 94, Column 41
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java
```java
>>>   94:     public static String getMD5Checksum(File file) throws IOException, NoSuchAlgorithmException {
```

### Data Flow Step 34: utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java, Line 95, Column 45
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java
```java
>>>   95:         final byte[] b = getChecksum("MD5", file);
```

### Data Flow Step 35: utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java, Line 68, Column 56
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java
```java
>>>   68:     public static byte[] getChecksum(String algorithm, File file) throws NoSuchAlgorithmException, IOException {
```

**Intermediate code within method `getChecksum` (lines 69-69):**
```java
      69:         final MessageDigest md = MessageDigest.getInstance(algorithm);
      70:         try (FileInputStream fis = new FileInputStream(file);
```

### Data Flow Step 36: utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java, Line 70, Column 56
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java
```java
>>>   70:         try (FileInputStream fis = new FileInputStream(file);
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 123, Column 67
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  123:                     try (InputStream in = new BufferedInputStream(conn.getInputStream());
```

### Data Flow Step 2: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 123, Column 43
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  123:                     try (InputStream in = new BufferedInputStream(conn.getInputStream());
```

### Data Flow Step 3: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 124, Column 71
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  124:                             JsonReader jsonReader = Json.createReader(in)) {
```

### Data Flow Step 4: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 124, Column 53
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  124:                             JsonReader jsonReader = Json.createReader(in)) {
```

### Data Flow Step 5: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 125, Column 49
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  125:                         final JsonArray array = jsonReader.readArray();
```

### Data Flow Step 6: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 125, Column 49
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  125:                         final JsonArray array = jsonReader.readArray();
```

**Intermediate code within method `submitPackage` (lines 126-128):**
```java
     126: 
     127:                         if (array != null) {
     128:                             for (int i = 0; i < array.size(); i++) {
     129:                                 final JsonObject object = array.getJsonObject(i);
```

### Data Flow Step 7: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 129, Column 59
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  129:                                 final JsonObject object = array.getJsonObject(i);
```

### Data Flow Step 8: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 129, Column 59
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  129:                                 final JsonObject object = array.getJsonObject(i);
```

**Intermediate code within method `submitPackage` (lines 130-144):**
```java
     130:                                 final Advisory advisory = new Advisory();
     131:                                 advisory.setId(object.getInt("id"));
     132:                                 advisory.setUpdatedAt(object.getString("updated_at", null));
     133:                                 advisory.setCreatedAt(object.getString("created_at", null));
     134:                                 advisory.setPublishDate(object.getString("publish_date", null));
     135:                                 advisory.setOverview(object.getString("overview"));
     136:                                 advisory.setRecommendation(object.getString("recommendation", null));
     137:                                 advisory.setCvssVector(object.getString("cvss_vector", null));
     138: 
     139:                                 if (object.get("cvss_score").getValueType() != ValueType.NULL) {
     140:                                     advisory.setCvssScore(Float.parseFloat(object.getJsonNumber("cvss_score").toString()));
     141:                                 } else {
     142:                                     advisory.setCvssScore(-1);
     143:                                 }
     144: 
     145:                                 advisory.setModule(object.getString("module", null));
```

### Data Flow Step 9: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 145, Column 52
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  145:                                 advisory.setModule(object.getString("module", null));
```

### Data Flow Step 10: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 145, Column 52
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  145:                                 advisory.setModule(object.getString("module", null));
```

### Data Flow Step 11: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 270, Column 27
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  270:     public void setModule(String module) {
```

### Data Flow Step 12: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 271, Column 23
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  271:         this.module = module;
```

### Data Flow Step 13: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 271, Column 9
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  271:         this.module = module;
```

### Data Flow Step 14: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 270, Column 17
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  270:     public void setModule(String module) {
```

### Data Flow Step 15: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 145, Column 33
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  145:                                 advisory.setModule(object.getString("module", null));
```

**Intermediate code within method `submitPackage` (lines 146-158):**
```java
     146:                                 advisory.setVersion(object.getString("version", null));
     147:                                 advisory.setVulnerableVersions(object.getString("vulnerable_versions", null));
     148:                                 advisory.setPatchedVersions(object.getString("patched_versions", null));
     149:                                 advisory.setTitle(object.getString("title", null));
     150:                                 advisory.setAdvisory(object.getString("advisory", null));
     151: 
     152:                                 final JsonArray jsonPath = object.getJsonArray("path");
     153:                                 final List<String> stringPath = new ArrayList<>();
     154:                                 for (int j = 0; j < jsonPath.size(); j++) {
     155:                                     stringPath.add(jsonPath.getString(j));
     156:                                 }
     157:                                 advisory.setPath(stringPath.toArray(new String[stringPath.size()]));
     158: 
     159:                                 result.add(advisory);
```

### Data Flow Step 16: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 159, Column 44
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  159:                                 result.add(advisory);
```

### Data Flow Step 17: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 159, Column 33
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  159:                                 result.add(advisory);
```

**Intermediate code within method `submitPackage` (lines 160-173):**
```java
     160:                             }
     161:                         }
     162:                     }
     163:                     break;
     164: 
     165:                 case 400:
     166:                     LOGGER.debug("Invalid payload submitted to Node Security Platform. Received response code: {} {}",
     167:                             conn.getResponseCode(), conn.getResponseMessage());
     168:                     throw new AnalysisException("Could not perform NSP analysis. Invalid payload submitted to Node Security Platform.");
     169:                 default:
     170:                     LOGGER.debug("Could not connect to Node Security Platform. Received response code: {} {}",
     171:                             conn.getResponseCode(), conn.getResponseMessage());
     172:                     throw new IOException("Could not connect to Node Security Platform");
     173:             }
     174:             return result;
```

### Data Flow Step 18: core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java, Line 174, Column 20
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/NspSearch.java
```java
>>>  174:             return result;
```

### Data Flow Step 19: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 178, Column 47
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  178:             final List<Advisory> advisories = searcher.submitPackage(nspPayload);
```

**Intermediate code within method `analyzeDependency` (lines 179-179):**
```java
     179: 
     180:             for (Advisory advisory : advisories) {
```

### Data Flow Step 20: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 180, Column 38
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  180:             for (Advisory advisory : advisories) {
```

**Intermediate code within method `analyzeDependency` (lines 181-184):**
```java
     181:                 /*
     182:                  * Create a new vulnerability out of the advisory returned by nsp.
     183:                  */
     184:                 final Vulnerability vuln = new Vulnerability();
     185:                 vuln.setCvssScore(advisory.getCvssScore());
```

### Data Flow Step 21: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 185, Column 35
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  185:                 vuln.setCvssScore(advisory.getCvssScore());
```

**Intermediate code within method `analyzeDependency` (lines 186-207):**
```java
     186:                 vuln.setDescription(advisory.getOverview());
     187:                 vuln.setName(String.valueOf(advisory.getId()));
     188:                 vuln.setSource(Vulnerability.Source.NSP);
     189:                 vuln.addReference(
     190:                         "NSP",
     191:                         "Advisory " + advisory.getId() + ": " + advisory.getTitle(),
     192:                         advisory.getAdvisory()
     193:                 );
     194: 
     195:                 /*
     196:                  * Create a single vulnerable software object - these do not use CPEs unlike the NVD.
     197:                  */
     198:                 final VulnerableSoftware vs = new VulnerableSoftware();
     199:                 //TODO consider changing this to available versions on the dependency
     200:                 //  - the update is a part of the version, not versions to update to
     201:                 //vs.setUpdate(advisory.getPatchedVersions());
     202: 
     203:                 vs.setName(advisory.getModule() + ":" + advisory.getVulnerableVersions());
     204:                 vuln.setVulnerableSoftware(new HashSet<>(Arrays.asList(vs)));
     205: 
     206:                 final Dependency existing = findDependency(engine, advisory.getModule(), advisory.getVersion());
     207:                 if (existing == null) {
     208:                     final Dependency nodeModule = createDependency(dependency, advisory.getModule(), advisory.getVersion(), "transitive");
```

### Data Flow Step 22: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 208, Column 80
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  208:                     final Dependency nodeModule = createDependency(dependency, advisory.getModule(), advisory.getVersion(), "transitive");
```

### Data Flow Step 23: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 261, Column 19
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  261:     public String getModule() {
```

### Data Flow Step 24: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 262, Column 16
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  262:         return module;
```

### Data Flow Step 25: core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java, Line 262, Column 16
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/data/nsp/Advisory.java
```java
>>>  262:         return module;
```

### Data Flow Step 26: core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java, Line 208, Column 80
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/NspAnalyzer.java
```java
>>>  208:                     final Dependency nodeModule = createDependency(dependency, advisory.getModule(), advisory.getVersion(), "transitive");
```

### Data Flow Step 27: core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java, Line 115, Column 66
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java
```java
>>>  115:     protected Dependency createDependency(Dependency dependency, String name, String version, String scope) {
```

### Data Flow Step 28: core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java, Line 116, Column 63
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java
```java
>>>  116:         final Dependency nodeModule = new Dependency(new File(dependency.getActualFile() + "?" + name), true);
```

### Data Flow Step 29: core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java, Line 116, Column 54
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/analyzer/AbstractNpmAnalyzer.java
```java
>>>  116:         final Dependency nodeModule = new Dependency(new File(dependency.getActualFile() + "?" + name), true);
```

### Data Flow Step 30: core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java, Line 185, Column 23
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java
```java
>>>  185:     public Dependency(File file, boolean isVirtual) {
```

### Data Flow Step 31: core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java, Line 192, Column 25
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java
```java
>>>  192:         determineHashes(file);
```

### Data Flow Step 32: core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java, Line 572, Column 34
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java
```java
>>>  572:     private void determineHashes(File file) {
```

**Intermediate code within method `determineHashes` (lines 573-579):**
```java
     573:         String md5 = null;
     574:         String sha1 = null;
     575:         if (isVirtual) {
     576:             return;
     577:         }
     578:         try {
     579:             md5 = Checksum.getMD5Checksum(file);
     580:             sha1 = Checksum.getSHA1Checksum(file);
```

### Data Flow Step 33: core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java, Line 580, Column 45
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/core/src/main/java/org/owasp/dependencycheck/dependency/Dependency.java
```java
>>>  580:             sha1 = Checksum.getSHA1Checksum(file);
```

### Data Flow Step 34: utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java, Line 107, Column 42
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java
```java
>>>  107:     public static String getSHA1Checksum(File file) throws IOException, NoSuchAlgorithmException {
```

### Data Flow Step 35: utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java, Line 108, Column 46
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java
```java
>>>  108:         final byte[] b = getChecksum("SHA1", file);
```

### Data Flow Step 36: utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java, Line 68, Column 56
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java
```java
>>>   68:     public static byte[] getChecksum(String algorithm, File file) throws NoSuchAlgorithmException, IOException {
```

**Intermediate code within method `getChecksum` (lines 69-69):**
```java
      69:         final MessageDigest md = MessageDigest.getInstance(algorithm);
      70:         try (FileInputStream fis = new FileInputStream(file);
```

### Data Flow Step 37: utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java, Line 70, Column 56
File: codeql-dbs/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/root/cwe-bench-java/project-sources/jeremylong__DependencyCheck_CVE-2018-12036_3.1.2/utils/src/main/java/org/owasp/dependencycheck/utils/Checksum.java
```java
>>>   70:         try (FileInputStream fis = new FileInputStream(file);
```
