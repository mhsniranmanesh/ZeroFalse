# Vulnerability: java/path-injection
## Message: This path depends on a [user-provided value](1).
This path depends on a [user-provided value](2).
This path depends on a [user-provided value](3).
This path depends on a [user-provided value](4).
This path depends on a [user-provided value](5).

## Code Flow 1

### Thread Flow 1

### Data Flow Step 1: src/main/java/spark/resource/AbstractResourceHandler.java, Line 50, Column 31
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   50:                 servletPath = request.getServletPath();
```

**Intermediate code within method `getResource` (lines 51-57):**
```java
      51:                 pathInfo = request.getPathInfo();
      52:             }
      53:         } else {
      54:             servletPath = request.getServletPath();
      55:             pathInfo = request.getPathInfo();
      56:         }
      57: 
      58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 2: src/main/java/spark/resource/AbstractResourceHandler.java, Line 58, Column 41
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 3: src/main/java/spark/resource/AbstractResourceHandler.java, Line 80, Column 35
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   80:     public static String addPaths(String segment1, String segment2) {
```

**Intermediate code within method `addPaths` (lines 81-82):**
```java
      81:         if (segment1 == null || segment1.length() == 0) {
      82:             if (segment1 != null && segment2 == null) {
      83:                 return segment1;
```

### Data Flow Step 4: src/main/java/spark/resource/AbstractResourceHandler.java, Line 83, Column 24
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   83:                 return segment1;
```

### Data Flow Step 5: src/main/java/spark/resource/AbstractResourceHandler.java, Line 58, Column 32
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 6: src/main/java/spark/resource/AbstractResourceHandler.java, Line 59, Column 28
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   59:         return getResource(pathInContext);
```

### Data Flow Step 7: src/main/java/spark/resource/ExternalResourceHandler.java, Line 59, Column 57
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   59:     protected AbstractFileResolvingResource getResource(String path) throws MalformedURLException {
```

**Intermediate code within method `getResource` (lines 60-64):**
```java
      60:         if (path == null || !path.startsWith("/")) {
      61:             throw new MalformedURLException(path);
      62:         }
      63: 
      64:         try {
      65:             path = UriPath.canonical(path);
```

### Data Flow Step 8: src/main/java/spark/resource/ExternalResourceHandler.java, Line 65, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   65:             path = UriPath.canonical(path);
```

### Data Flow Step 9: src/main/java/spark/resource/UriPath.java, Line 32, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/UriPath.java
```java
>>>   32:     public static String canonical(String path) {
```

**Intermediate code within method `canonical` (lines 33-33):**
```java
      33:         if (path == null || path.length() == 0) {
      34:             return path;
```

### Data Flow Step 10: src/main/java/spark/resource/UriPath.java, Line 34, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/UriPath.java
```java
>>>   34:             return path;
```

### Data Flow Step 11: src/main/java/spark/resource/ExternalResourceHandler.java, Line 65, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   65:             path = UriPath.canonical(path);
```

**Intermediate code within method `getResource` (lines 66-66):**
```java
      66: 
      67:             final String addedPath = addPaths(baseResource, path);
```

### Data Flow Step 12: src/main/java/spark/resource/ExternalResourceHandler.java, Line 67, Column 61
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   67:             final String addedPath = addPaths(baseResource, path);
```

### Data Flow Step 13: src/main/java/spark/resource/AbstractResourceHandler.java, Line 80, Column 52
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   80:     public static String addPaths(String segment1, String segment2) {
```

**Intermediate code within method `addPaths` (lines 81-84):**
```java
      81:         if (segment1 == null || segment1.length() == 0) {
      82:             if (segment1 != null && segment2 == null) {
      83:                 return segment1;
      84:             }
      85:             return segment2;
```

### Data Flow Step 14: src/main/java/spark/resource/AbstractResourceHandler.java, Line 85, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   85:             return segment2;
```

### Data Flow Step 15: src/main/java/spark/resource/ExternalResourceHandler.java, Line 67, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   67:             final String addedPath = addPaths(baseResource, path);
```

**Intermediate code within method `getResource` (lines 68-68):**
```java
      68: 
      69:             ExternalResource resource = new ExternalResource(addedPath);
```

### Data Flow Step 16: src/main/java/spark/resource/ExternalResourceHandler.java, Line 69, Column 62
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   69:             ExternalResource resource = new ExternalResource(addedPath);
```

### Data Flow Step 17: src/main/java/spark/resource/ExternalResource.java, Line 39, Column 29
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   39:     public ExternalResource(String path) {
```

### Data Flow Step 18: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 47
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 19: src/main/java/spark/utils/StringUtils.java, Line 218, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  218:     public static String cleanPath(String path) {
```

**Intermediate code within method `cleanPath` (lines 219-221):**
```java
     219:         if (path == null) {
     220:             return null;
     221:         }
     222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

### Data Flow Step 20: src/main/java/spark/utils/StringUtils.java, Line 222, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

### Data Flow Step 21: src/main/java/spark/utils/StringUtils.java, Line 131, Column 34
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  131:     public static String replace(String inString, String oldPattern, String newPattern) {
```

**Intermediate code within method `replace` (lines 132-132):**
```java
     132:         if (!hasLength(inString) || !hasLength(oldPattern) || newPattern == null) {
     133:             return inString;
```

### Data Flow Step 22: src/main/java/spark/utils/StringUtils.java, Line 133, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  133:             return inString;
```

### Data Flow Step 23: src/main/java/spark/utils/StringUtils.java, Line 222, Column 28
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

**Intermediate code within method `cleanPath` (lines 223-230):**
```java
     223: 
     224:         // Strip prefix from path to analyze, to not treat it as part of the
     225:         // first path element. This is necessary to correctly parse paths like
     226:         // "file:core/../core/io/Resource.class", where the ".." should just
     227:         // strip the first "core" directory while keeping the "file:" prefix.
     228:         int prefixIndex = pathToUse.indexOf(":");
     229:         String prefix = "";
     230:         if (prefixIndex != -1) {
     231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

### Data Flow Step 24: src/main/java/spark/utils/StringUtils.java, Line 231, Column 22
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

### Data Flow Step 25: src/main/java/spark/utils/StringUtils.java, Line 231, Column 22
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

**Intermediate code within method `cleanPath` (lines 232-265):**
```java
     232:             pathToUse = pathToUse.substring(prefixIndex + 1);
     233:         }
     234:         if (pathToUse.startsWith(FOLDER_SEPARATOR)) {
     235:             prefix = prefix + FOLDER_SEPARATOR;
     236:             pathToUse = pathToUse.substring(1);
     237:         }
     238: 
     239:         String[] pathArray = delimitedListToStringArray(pathToUse, FOLDER_SEPARATOR);
     240:         List<String> pathElements = new LinkedList<>();
     241:         int tops = 0;
     242: 
     243:         for (int i = pathArray.length - 1; i >= 0; i--) {
     244:             String element = pathArray[i];
     245:             if (CURRENT_PATH.equals(element)) {
     246:                 // Points to current directory - drop it.
     247:             } else if (TOP_PATH.equals(element)) {
     248:                 // Registering top path found.
     249:                 tops++;
     250:             } else {
     251:                 if (tops > 0) {
     252:                     // Merging path element with element corresponding to top path.
     253:                     tops--;
     254:                 } else {
     255:                     // Normal path element found.
     256:                     pathElements.add(0, element);
     257:                 }
     258:             }
     259:         }
     260: 
     261:         // Remaining top paths need to be retained.
     262:         for (int i = 0; i < tops; i++) {
     263:             pathElements.add(0, TOP_PATH);
     264:         }
     265: 
     266:         return prefix + collectionToDelimitedString(pathElements, FOLDER_SEPARATOR);
```

### Data Flow Step 26: src/main/java/spark/utils/StringUtils.java, Line 266, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  266:         return prefix + collectionToDelimitedString(pathElements, FOLDER_SEPARATOR);
```

### Data Flow Step 27: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 25
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 28: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 29: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 9
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 30: src/main/java/spark/resource/ExternalResource.java, Line 39, Column 12
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   39:     public ExternalResource(String path) {
```

### Data Flow Step 31: src/main/java/spark/resource/ExternalResourceHandler.java, Line 69, Column 41
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   69:             ExternalResource resource = new ExternalResource(addedPath);
```

**Intermediate code within method `getResource` (lines 70-70):**
```java
      70: 
      71:             if (resource.exists() && resource.isDirectory()) {
```

### Data Flow Step 32: src/main/java/spark/resource/ExternalResourceHandler.java, Line 71, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   71:             if (resource.exists() && resource.isDirectory()) {
```

### Data Flow Step 33: src/main/java/spark/resource/ExternalResource.java, Line 51, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   51:     public boolean isDirectory() {
```

### Data Flow Step 34: src/main/java/spark/resource/ExternalResource.java, Line 52, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   52:         return file.isDirectory();
```

### Data Flow Step 35: src/main/java/spark/resource/ExternalResource.java, Line 52, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   52:         return file.isDirectory();
```

## Code Flow 2

### Thread Flow 1

### Data Flow Step 1: src/main/java/spark/resource/AbstractResourceHandler.java, Line 51, Column 28
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   51:                 pathInfo = request.getPathInfo();
```

**Intermediate code within method `getResource` (lines 52-57):**
```java
      52:             }
      53:         } else {
      54:             servletPath = request.getServletPath();
      55:             pathInfo = request.getPathInfo();
      56:         }
      57: 
      58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 2: src/main/java/spark/resource/AbstractResourceHandler.java, Line 58, Column 54
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 3: src/main/java/spark/resource/AbstractResourceHandler.java, Line 80, Column 52
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   80:     public static String addPaths(String segment1, String segment2) {
```

**Intermediate code within method `addPaths` (lines 81-84):**
```java
      81:         if (segment1 == null || segment1.length() == 0) {
      82:             if (segment1 != null && segment2 == null) {
      83:                 return segment1;
      84:             }
      85:             return segment2;
```

### Data Flow Step 4: src/main/java/spark/resource/AbstractResourceHandler.java, Line 85, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   85:             return segment2;
```

### Data Flow Step 5: src/main/java/spark/resource/AbstractResourceHandler.java, Line 58, Column 32
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 6: src/main/java/spark/resource/AbstractResourceHandler.java, Line 59, Column 28
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   59:         return getResource(pathInContext);
```

### Data Flow Step 7: src/main/java/spark/resource/ExternalResourceHandler.java, Line 59, Column 57
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   59:     protected AbstractFileResolvingResource getResource(String path) throws MalformedURLException {
```

**Intermediate code within method `getResource` (lines 60-64):**
```java
      60:         if (path == null || !path.startsWith("/")) {
      61:             throw new MalformedURLException(path);
      62:         }
      63: 
      64:         try {
      65:             path = UriPath.canonical(path);
```

### Data Flow Step 8: src/main/java/spark/resource/ExternalResourceHandler.java, Line 65, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   65:             path = UriPath.canonical(path);
```

### Data Flow Step 9: src/main/java/spark/resource/UriPath.java, Line 32, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/UriPath.java
```java
>>>   32:     public static String canonical(String path) {
```

**Intermediate code within method `canonical` (lines 33-33):**
```java
      33:         if (path == null || path.length() == 0) {
      34:             return path;
```

### Data Flow Step 10: src/main/java/spark/resource/UriPath.java, Line 34, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/UriPath.java
```java
>>>   34:             return path;
```

### Data Flow Step 11: src/main/java/spark/resource/ExternalResourceHandler.java, Line 65, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   65:             path = UriPath.canonical(path);
```

**Intermediate code within method `getResource` (lines 66-66):**
```java
      66: 
      67:             final String addedPath = addPaths(baseResource, path);
```

### Data Flow Step 12: src/main/java/spark/resource/ExternalResourceHandler.java, Line 67, Column 61
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   67:             final String addedPath = addPaths(baseResource, path);
```

### Data Flow Step 13: src/main/java/spark/resource/AbstractResourceHandler.java, Line 80, Column 52
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   80:     public static String addPaths(String segment1, String segment2) {
```

**Intermediate code within method `addPaths` (lines 81-84):**
```java
      81:         if (segment1 == null || segment1.length() == 0) {
      82:             if (segment1 != null && segment2 == null) {
      83:                 return segment1;
      84:             }
      85:             return segment2;
```

### Data Flow Step 14: src/main/java/spark/resource/AbstractResourceHandler.java, Line 85, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   85:             return segment2;
```

### Data Flow Step 15: src/main/java/spark/resource/ExternalResourceHandler.java, Line 67, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   67:             final String addedPath = addPaths(baseResource, path);
```

**Intermediate code within method `getResource` (lines 68-68):**
```java
      68: 
      69:             ExternalResource resource = new ExternalResource(addedPath);
```

### Data Flow Step 16: src/main/java/spark/resource/ExternalResourceHandler.java, Line 69, Column 62
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   69:             ExternalResource resource = new ExternalResource(addedPath);
```

### Data Flow Step 17: src/main/java/spark/resource/ExternalResource.java, Line 39, Column 29
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   39:     public ExternalResource(String path) {
```

### Data Flow Step 18: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 47
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 19: src/main/java/spark/utils/StringUtils.java, Line 218, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  218:     public static String cleanPath(String path) {
```

**Intermediate code within method `cleanPath` (lines 219-221):**
```java
     219:         if (path == null) {
     220:             return null;
     221:         }
     222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

### Data Flow Step 20: src/main/java/spark/utils/StringUtils.java, Line 222, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

### Data Flow Step 21: src/main/java/spark/utils/StringUtils.java, Line 131, Column 34
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  131:     public static String replace(String inString, String oldPattern, String newPattern) {
```

**Intermediate code within method `replace` (lines 132-132):**
```java
     132:         if (!hasLength(inString) || !hasLength(oldPattern) || newPattern == null) {
     133:             return inString;
```

### Data Flow Step 22: src/main/java/spark/utils/StringUtils.java, Line 133, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  133:             return inString;
```

### Data Flow Step 23: src/main/java/spark/utils/StringUtils.java, Line 222, Column 28
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

**Intermediate code within method `cleanPath` (lines 223-230):**
```java
     223: 
     224:         // Strip prefix from path to analyze, to not treat it as part of the
     225:         // first path element. This is necessary to correctly parse paths like
     226:         // "file:core/../core/io/Resource.class", where the ".." should just
     227:         // strip the first "core" directory while keeping the "file:" prefix.
     228:         int prefixIndex = pathToUse.indexOf(":");
     229:         String prefix = "";
     230:         if (prefixIndex != -1) {
     231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

### Data Flow Step 24: src/main/java/spark/utils/StringUtils.java, Line 231, Column 22
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

### Data Flow Step 25: src/main/java/spark/utils/StringUtils.java, Line 231, Column 22
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

**Intermediate code within method `cleanPath` (lines 232-265):**
```java
     232:             pathToUse = pathToUse.substring(prefixIndex + 1);
     233:         }
     234:         if (pathToUse.startsWith(FOLDER_SEPARATOR)) {
     235:             prefix = prefix + FOLDER_SEPARATOR;
     236:             pathToUse = pathToUse.substring(1);
     237:         }
     238: 
     239:         String[] pathArray = delimitedListToStringArray(pathToUse, FOLDER_SEPARATOR);
     240:         List<String> pathElements = new LinkedList<>();
     241:         int tops = 0;
     242: 
     243:         for (int i = pathArray.length - 1; i >= 0; i--) {
     244:             String element = pathArray[i];
     245:             if (CURRENT_PATH.equals(element)) {
     246:                 // Points to current directory - drop it.
     247:             } else if (TOP_PATH.equals(element)) {
     248:                 // Registering top path found.
     249:                 tops++;
     250:             } else {
     251:                 if (tops > 0) {
     252:                     // Merging path element with element corresponding to top path.
     253:                     tops--;
     254:                 } else {
     255:                     // Normal path element found.
     256:                     pathElements.add(0, element);
     257:                 }
     258:             }
     259:         }
     260: 
     261:         // Remaining top paths need to be retained.
     262:         for (int i = 0; i < tops; i++) {
     263:             pathElements.add(0, TOP_PATH);
     264:         }
     265: 
     266:         return prefix + collectionToDelimitedString(pathElements, FOLDER_SEPARATOR);
```

### Data Flow Step 26: src/main/java/spark/utils/StringUtils.java, Line 266, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  266:         return prefix + collectionToDelimitedString(pathElements, FOLDER_SEPARATOR);
```

### Data Flow Step 27: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 25
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 28: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 29: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 9
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 30: src/main/java/spark/resource/ExternalResource.java, Line 39, Column 12
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   39:     public ExternalResource(String path) {
```

### Data Flow Step 31: src/main/java/spark/resource/ExternalResourceHandler.java, Line 69, Column 41
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   69:             ExternalResource resource = new ExternalResource(addedPath);
```

**Intermediate code within method `getResource` (lines 70-70):**
```java
      70: 
      71:             if (resource.exists() && resource.isDirectory()) {
```

### Data Flow Step 32: src/main/java/spark/resource/ExternalResourceHandler.java, Line 71, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   71:             if (resource.exists() && resource.isDirectory()) {
```

### Data Flow Step 33: src/main/java/spark/resource/ExternalResource.java, Line 51, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   51:     public boolean isDirectory() {
```

### Data Flow Step 34: src/main/java/spark/resource/ExternalResource.java, Line 52, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   52:         return file.isDirectory();
```

### Data Flow Step 35: src/main/java/spark/resource/ExternalResource.java, Line 52, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   52:         return file.isDirectory();
```

## Code Flow 3

### Thread Flow 1

### Data Flow Step 1: src/main/java/spark/resource/AbstractResourceHandler.java, Line 54, Column 27
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   54:             servletPath = request.getServletPath();
```

**Intermediate code within method `getResource` (lines 55-57):**
```java
      55:             pathInfo = request.getPathInfo();
      56:         }
      57: 
      58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 2: src/main/java/spark/resource/AbstractResourceHandler.java, Line 58, Column 41
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 3: src/main/java/spark/resource/AbstractResourceHandler.java, Line 80, Column 35
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   80:     public static String addPaths(String segment1, String segment2) {
```

**Intermediate code within method `addPaths` (lines 81-82):**
```java
      81:         if (segment1 == null || segment1.length() == 0) {
      82:             if (segment1 != null && segment2 == null) {
      83:                 return segment1;
```

### Data Flow Step 4: src/main/java/spark/resource/AbstractResourceHandler.java, Line 83, Column 24
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   83:                 return segment1;
```

### Data Flow Step 5: src/main/java/spark/resource/AbstractResourceHandler.java, Line 58, Column 32
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 6: src/main/java/spark/resource/AbstractResourceHandler.java, Line 59, Column 28
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   59:         return getResource(pathInContext);
```

### Data Flow Step 7: src/main/java/spark/resource/ExternalResourceHandler.java, Line 59, Column 57
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   59:     protected AbstractFileResolvingResource getResource(String path) throws MalformedURLException {
```

**Intermediate code within method `getResource` (lines 60-64):**
```java
      60:         if (path == null || !path.startsWith("/")) {
      61:             throw new MalformedURLException(path);
      62:         }
      63: 
      64:         try {
      65:             path = UriPath.canonical(path);
```

### Data Flow Step 8: src/main/java/spark/resource/ExternalResourceHandler.java, Line 65, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   65:             path = UriPath.canonical(path);
```

### Data Flow Step 9: src/main/java/spark/resource/UriPath.java, Line 32, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/UriPath.java
```java
>>>   32:     public static String canonical(String path) {
```

**Intermediate code within method `canonical` (lines 33-33):**
```java
      33:         if (path == null || path.length() == 0) {
      34:             return path;
```

### Data Flow Step 10: src/main/java/spark/resource/UriPath.java, Line 34, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/UriPath.java
```java
>>>   34:             return path;
```

### Data Flow Step 11: src/main/java/spark/resource/ExternalResourceHandler.java, Line 65, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   65:             path = UriPath.canonical(path);
```

**Intermediate code within method `getResource` (lines 66-66):**
```java
      66: 
      67:             final String addedPath = addPaths(baseResource, path);
```

### Data Flow Step 12: src/main/java/spark/resource/ExternalResourceHandler.java, Line 67, Column 61
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   67:             final String addedPath = addPaths(baseResource, path);
```

### Data Flow Step 13: src/main/java/spark/resource/AbstractResourceHandler.java, Line 80, Column 52
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   80:     public static String addPaths(String segment1, String segment2) {
```

**Intermediate code within method `addPaths` (lines 81-84):**
```java
      81:         if (segment1 == null || segment1.length() == 0) {
      82:             if (segment1 != null && segment2 == null) {
      83:                 return segment1;
      84:             }
      85:             return segment2;
```

### Data Flow Step 14: src/main/java/spark/resource/AbstractResourceHandler.java, Line 85, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   85:             return segment2;
```

### Data Flow Step 15: src/main/java/spark/resource/ExternalResourceHandler.java, Line 67, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   67:             final String addedPath = addPaths(baseResource, path);
```

**Intermediate code within method `getResource` (lines 68-68):**
```java
      68: 
      69:             ExternalResource resource = new ExternalResource(addedPath);
```

### Data Flow Step 16: src/main/java/spark/resource/ExternalResourceHandler.java, Line 69, Column 62
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   69:             ExternalResource resource = new ExternalResource(addedPath);
```

### Data Flow Step 17: src/main/java/spark/resource/ExternalResource.java, Line 39, Column 29
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   39:     public ExternalResource(String path) {
```

### Data Flow Step 18: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 47
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 19: src/main/java/spark/utils/StringUtils.java, Line 218, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  218:     public static String cleanPath(String path) {
```

**Intermediate code within method `cleanPath` (lines 219-221):**
```java
     219:         if (path == null) {
     220:             return null;
     221:         }
     222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

### Data Flow Step 20: src/main/java/spark/utils/StringUtils.java, Line 222, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

### Data Flow Step 21: src/main/java/spark/utils/StringUtils.java, Line 131, Column 34
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  131:     public static String replace(String inString, String oldPattern, String newPattern) {
```

**Intermediate code within method `replace` (lines 132-132):**
```java
     132:         if (!hasLength(inString) || !hasLength(oldPattern) || newPattern == null) {
     133:             return inString;
```

### Data Flow Step 22: src/main/java/spark/utils/StringUtils.java, Line 133, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  133:             return inString;
```

### Data Flow Step 23: src/main/java/spark/utils/StringUtils.java, Line 222, Column 28
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

**Intermediate code within method `cleanPath` (lines 223-230):**
```java
     223: 
     224:         // Strip prefix from path to analyze, to not treat it as part of the
     225:         // first path element. This is necessary to correctly parse paths like
     226:         // "file:core/../core/io/Resource.class", where the ".." should just
     227:         // strip the first "core" directory while keeping the "file:" prefix.
     228:         int prefixIndex = pathToUse.indexOf(":");
     229:         String prefix = "";
     230:         if (prefixIndex != -1) {
     231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

### Data Flow Step 24: src/main/java/spark/utils/StringUtils.java, Line 231, Column 22
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

### Data Flow Step 25: src/main/java/spark/utils/StringUtils.java, Line 231, Column 22
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

**Intermediate code within method `cleanPath` (lines 232-265):**
```java
     232:             pathToUse = pathToUse.substring(prefixIndex + 1);
     233:         }
     234:         if (pathToUse.startsWith(FOLDER_SEPARATOR)) {
     235:             prefix = prefix + FOLDER_SEPARATOR;
     236:             pathToUse = pathToUse.substring(1);
     237:         }
     238: 
     239:         String[] pathArray = delimitedListToStringArray(pathToUse, FOLDER_SEPARATOR);
     240:         List<String> pathElements = new LinkedList<>();
     241:         int tops = 0;
     242: 
     243:         for (int i = pathArray.length - 1; i >= 0; i--) {
     244:             String element = pathArray[i];
     245:             if (CURRENT_PATH.equals(element)) {
     246:                 // Points to current directory - drop it.
     247:             } else if (TOP_PATH.equals(element)) {
     248:                 // Registering top path found.
     249:                 tops++;
     250:             } else {
     251:                 if (tops > 0) {
     252:                     // Merging path element with element corresponding to top path.
     253:                     tops--;
     254:                 } else {
     255:                     // Normal path element found.
     256:                     pathElements.add(0, element);
     257:                 }
     258:             }
     259:         }
     260: 
     261:         // Remaining top paths need to be retained.
     262:         for (int i = 0; i < tops; i++) {
     263:             pathElements.add(0, TOP_PATH);
     264:         }
     265: 
     266:         return prefix + collectionToDelimitedString(pathElements, FOLDER_SEPARATOR);
```

### Data Flow Step 26: src/main/java/spark/utils/StringUtils.java, Line 266, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  266:         return prefix + collectionToDelimitedString(pathElements, FOLDER_SEPARATOR);
```

### Data Flow Step 27: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 25
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 28: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 29: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 9
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 30: src/main/java/spark/resource/ExternalResource.java, Line 39, Column 12
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   39:     public ExternalResource(String path) {
```

### Data Flow Step 31: src/main/java/spark/resource/ExternalResourceHandler.java, Line 69, Column 41
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   69:             ExternalResource resource = new ExternalResource(addedPath);
```

**Intermediate code within method `getResource` (lines 70-70):**
```java
      70: 
      71:             if (resource.exists() && resource.isDirectory()) {
```

### Data Flow Step 32: src/main/java/spark/resource/ExternalResourceHandler.java, Line 71, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   71:             if (resource.exists() && resource.isDirectory()) {
```

### Data Flow Step 33: src/main/java/spark/resource/ExternalResource.java, Line 51, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   51:     public boolean isDirectory() {
```

### Data Flow Step 34: src/main/java/spark/resource/ExternalResource.java, Line 52, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   52:         return file.isDirectory();
```

### Data Flow Step 35: src/main/java/spark/resource/ExternalResource.java, Line 52, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   52:         return file.isDirectory();
```

## Code Flow 4

### Thread Flow 1

### Data Flow Step 1: src/main/java/spark/resource/AbstractResourceHandler.java, Line 55, Column 24
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   55:             pathInfo = request.getPathInfo();
```

**Intermediate code within method `getResource` (lines 56-57):**
```java
      56:         }
      57: 
      58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 2: src/main/java/spark/resource/AbstractResourceHandler.java, Line 58, Column 54
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 3: src/main/java/spark/resource/AbstractResourceHandler.java, Line 80, Column 52
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   80:     public static String addPaths(String segment1, String segment2) {
```

**Intermediate code within method `addPaths` (lines 81-84):**
```java
      81:         if (segment1 == null || segment1.length() == 0) {
      82:             if (segment1 != null && segment2 == null) {
      83:                 return segment1;
      84:             }
      85:             return segment2;
```

### Data Flow Step 4: src/main/java/spark/resource/AbstractResourceHandler.java, Line 85, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   85:             return segment2;
```

### Data Flow Step 5: src/main/java/spark/resource/AbstractResourceHandler.java, Line 58, Column 32
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   58:         String pathInContext = addPaths(servletPath, pathInfo);
```

### Data Flow Step 6: src/main/java/spark/resource/AbstractResourceHandler.java, Line 59, Column 28
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   59:         return getResource(pathInContext);
```

### Data Flow Step 7: src/main/java/spark/resource/ExternalResourceHandler.java, Line 59, Column 57
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   59:     protected AbstractFileResolvingResource getResource(String path) throws MalformedURLException {
```

**Intermediate code within method `getResource` (lines 60-64):**
```java
      60:         if (path == null || !path.startsWith("/")) {
      61:             throw new MalformedURLException(path);
      62:         }
      63: 
      64:         try {
      65:             path = UriPath.canonical(path);
```

### Data Flow Step 8: src/main/java/spark/resource/ExternalResourceHandler.java, Line 65, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   65:             path = UriPath.canonical(path);
```

### Data Flow Step 9: src/main/java/spark/resource/UriPath.java, Line 32, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/UriPath.java
```java
>>>   32:     public static String canonical(String path) {
```

**Intermediate code within method `canonical` (lines 33-33):**
```java
      33:         if (path == null || path.length() == 0) {
      34:             return path;
```

### Data Flow Step 10: src/main/java/spark/resource/UriPath.java, Line 34, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/UriPath.java
```java
>>>   34:             return path;
```

### Data Flow Step 11: src/main/java/spark/resource/ExternalResourceHandler.java, Line 65, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   65:             path = UriPath.canonical(path);
```

**Intermediate code within method `getResource` (lines 66-66):**
```java
      66: 
      67:             final String addedPath = addPaths(baseResource, path);
```

### Data Flow Step 12: src/main/java/spark/resource/ExternalResourceHandler.java, Line 67, Column 61
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   67:             final String addedPath = addPaths(baseResource, path);
```

### Data Flow Step 13: src/main/java/spark/resource/AbstractResourceHandler.java, Line 80, Column 52
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   80:     public static String addPaths(String segment1, String segment2) {
```

**Intermediate code within method `addPaths` (lines 81-84):**
```java
      81:         if (segment1 == null || segment1.length() == 0) {
      82:             if (segment1 != null && segment2 == null) {
      83:                 return segment1;
      84:             }
      85:             return segment2;
```

### Data Flow Step 14: src/main/java/spark/resource/AbstractResourceHandler.java, Line 85, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/AbstractResourceHandler.java
```java
>>>   85:             return segment2;
```

### Data Flow Step 15: src/main/java/spark/resource/ExternalResourceHandler.java, Line 67, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   67:             final String addedPath = addPaths(baseResource, path);
```

**Intermediate code within method `getResource` (lines 68-68):**
```java
      68: 
      69:             ExternalResource resource = new ExternalResource(addedPath);
```

### Data Flow Step 16: src/main/java/spark/resource/ExternalResourceHandler.java, Line 69, Column 62
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   69:             ExternalResource resource = new ExternalResource(addedPath);
```

### Data Flow Step 17: src/main/java/spark/resource/ExternalResource.java, Line 39, Column 29
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   39:     public ExternalResource(String path) {
```

### Data Flow Step 18: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 47
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 19: src/main/java/spark/utils/StringUtils.java, Line 218, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  218:     public static String cleanPath(String path) {
```

**Intermediate code within method `cleanPath` (lines 219-221):**
```java
     219:         if (path == null) {
     220:             return null;
     221:         }
     222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

### Data Flow Step 20: src/main/java/spark/utils/StringUtils.java, Line 222, Column 36
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

### Data Flow Step 21: src/main/java/spark/utils/StringUtils.java, Line 131, Column 34
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  131:     public static String replace(String inString, String oldPattern, String newPattern) {
```

**Intermediate code within method `replace` (lines 132-132):**
```java
     132:         if (!hasLength(inString) || !hasLength(oldPattern) || newPattern == null) {
     133:             return inString;
```

### Data Flow Step 22: src/main/java/spark/utils/StringUtils.java, Line 133, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  133:             return inString;
```

### Data Flow Step 23: src/main/java/spark/utils/StringUtils.java, Line 222, Column 28
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  222:         String pathToUse = replace(path, WINDOWS_FOLDER_SEPARATOR, FOLDER_SEPARATOR);
```

**Intermediate code within method `cleanPath` (lines 223-230):**
```java
     223: 
     224:         // Strip prefix from path to analyze, to not treat it as part of the
     225:         // first path element. This is necessary to correctly parse paths like
     226:         // "file:core/../core/io/Resource.class", where the ".." should just
     227:         // strip the first "core" directory while keeping the "file:" prefix.
     228:         int prefixIndex = pathToUse.indexOf(":");
     229:         String prefix = "";
     230:         if (prefixIndex != -1) {
     231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

### Data Flow Step 24: src/main/java/spark/utils/StringUtils.java, Line 231, Column 22
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

### Data Flow Step 25: src/main/java/spark/utils/StringUtils.java, Line 231, Column 22
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  231:             prefix = pathToUse.substring(0, prefixIndex + 1);
```

**Intermediate code within method `cleanPath` (lines 232-265):**
```java
     232:             pathToUse = pathToUse.substring(prefixIndex + 1);
     233:         }
     234:         if (pathToUse.startsWith(FOLDER_SEPARATOR)) {
     235:             prefix = prefix + FOLDER_SEPARATOR;
     236:             pathToUse = pathToUse.substring(1);
     237:         }
     238: 
     239:         String[] pathArray = delimitedListToStringArray(pathToUse, FOLDER_SEPARATOR);
     240:         List<String> pathElements = new LinkedList<>();
     241:         int tops = 0;
     242: 
     243:         for (int i = pathArray.length - 1; i >= 0; i--) {
     244:             String element = pathArray[i];
     245:             if (CURRENT_PATH.equals(element)) {
     246:                 // Points to current directory - drop it.
     247:             } else if (TOP_PATH.equals(element)) {
     248:                 // Registering top path found.
     249:                 tops++;
     250:             } else {
     251:                 if (tops > 0) {
     252:                     // Merging path element with element corresponding to top path.
     253:                     tops--;
     254:                 } else {
     255:                     // Normal path element found.
     256:                     pathElements.add(0, element);
     257:                 }
     258:             }
     259:         }
     260: 
     261:         // Remaining top paths need to be retained.
     262:         for (int i = 0; i < tops; i++) {
     263:             pathElements.add(0, TOP_PATH);
     264:         }
     265: 
     266:         return prefix + collectionToDelimitedString(pathElements, FOLDER_SEPARATOR);
```

### Data Flow Step 26: src/main/java/spark/utils/StringUtils.java, Line 266, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/utils/StringUtils.java
```java
>>>  266:         return prefix + collectionToDelimitedString(pathElements, FOLDER_SEPARATOR);
```

### Data Flow Step 27: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 25
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 28: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 29: src/main/java/spark/resource/ExternalResource.java, Line 40, Column 9
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   40:         file = new File(StringUtils.cleanPath(path));
```

### Data Flow Step 30: src/main/java/spark/resource/ExternalResource.java, Line 39, Column 12
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   39:     public ExternalResource(String path) {
```

### Data Flow Step 31: src/main/java/spark/resource/ExternalResourceHandler.java, Line 69, Column 41
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   69:             ExternalResource resource = new ExternalResource(addedPath);
```

**Intermediate code within method `getResource` (lines 70-70):**
```java
      70: 
      71:             if (resource.exists() && resource.isDirectory()) {
```

### Data Flow Step 32: src/main/java/spark/resource/ExternalResourceHandler.java, Line 71, Column 38
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResourceHandler.java
```java
>>>   71:             if (resource.exists() && resource.isDirectory()) {
```

### Data Flow Step 33: src/main/java/spark/resource/ExternalResource.java, Line 51, Column 20
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   51:     public boolean isDirectory() {
```

### Data Flow Step 34: src/main/java/spark/resource/ExternalResource.java, Line 52, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   52:         return file.isDirectory();
```

### Data Flow Step 35: src/main/java/spark/resource/ExternalResource.java, Line 52, Column 16
File: codeql-dbs/perwendel__spark_CVE-2016-9177_2.5.1/root/cwe-bench-java/project-sources/perwendel__spark_CVE-2016-9177_2.5.1/src/main/java/spark/resource/ExternalResource.java
```java
>>>   52:         return file.isDirectory();
```
